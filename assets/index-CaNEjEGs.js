const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-Dfl3qsnW.js","assets/index-BQocgDvE.js","assets/index-Cjp2Xj_Y.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{R as K,r as i,c as le,j as o,T as St,t as kt,a as F,s as Y,b as Ot,E as Rt,d as Tt,e as Mt,f as At,u as $,g as Ft,P as Se,h as Be,o as Ze,i as Bt,k as et,l as Lt,m as Ut,n as G,p as We,q as He,K as $t,v as ne,w as Dt,x as It,y as Pt,z as zt,A as Ve,F as tt,B as Wt,C as Ht,D as nt,L as ot,G as qe,H as Vt,S as Fe,I as qt,J as Kt,_ as Gt,M as Xt,N as Yt}from"./index-BQocgDvE.js";import{F as Qt,N as Jt}from"./NoDataMessage-CmtjnB75.js";import{u as Zt,a as st,i as en,r as Ke,h as tn,f as nn}from"./utils-C0ge9RdV.js";const on={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function sn(t,e){const n=`offset${t[0].toUpperCase()}${t.slice(1)}`,s=e[n],r=on[t];return s+parseInt(Y(e,r[0]),10)+parseInt(Y(e,r[1]),10)}const rn={[At]:"collapse",[Mt]:"collapsing",[Tt]:"collapsing",[Rt]:"collapse show"},an=K.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:s,onExiting:r,className:a,children:d,dimension:h="height",in:f=!1,timeout:g=300,mountOnEnter:y=!1,unmountOnExit:C=!1,appear:j=!1,getDimensionValue:x=sn,...m},N)=>{const l=typeof h=="function"?h():h,p=i.useMemo(()=>le(w=>{w.style[l]="0"},t),[l,t]),E=i.useMemo(()=>le(w=>{const v=`scroll${l[0].toUpperCase()}${l.slice(1)}`;w.style[l]=`${w[v]}px`},e),[l,e]),S=i.useMemo(()=>le(w=>{w.style[l]=null},n),[l,n]),B=i.useMemo(()=>le(w=>{w.style[l]=`${x(l,w)}px`,Ot(w)},s),[s,x,l]),T=i.useMemo(()=>le(w=>{w.style[l]=null},r),[l,r]);return o.jsx(St,{ref:N,addEndListener:kt,...m,"aria-expanded":m.role?f:null,onEnter:p,onEntering:E,onEntered:S,onExit:B,onExiting:T,childRef:d.ref,in:f,timeout:g,mountOnEnter:y,unmountOnExit:C,appear:j,children:(w,v)=>K.cloneElement(d,{...v,className:F(a,d.props.className,rn[w],l==="width"&&"collapse-horizontal")})})});function rt(t,e){return Array.isArray(t)?t.includes(e):t===e}const ue=i.createContext({});ue.displayName="AccordionContext";const Le=i.forwardRef(({as:t="div",bsPrefix:e,className:n,children:s,eventKey:r,...a},d)=>{const{activeEventKey:h}=i.useContext(ue);return e=$(e,"accordion-collapse"),o.jsx(an,{ref:d,in:rt(h,r),...a,className:F(n,e),children:o.jsx(t,{children:i.Children.only(s)})})});Le.displayName="AccordionCollapse";const Ce=i.createContext({eventKey:""});Ce.displayName="AccordionItemContext";const at=i.forwardRef(({as:t="div",bsPrefix:e,className:n,onEnter:s,onEntering:r,onEntered:a,onExit:d,onExiting:h,onExited:f,...g},y)=>{e=$(e,"accordion-body");const{eventKey:C}=i.useContext(Ce);return o.jsx(Le,{eventKey:C,onEnter:s,onEntering:r,onEntered:a,onExit:d,onExiting:h,onExited:f,children:o.jsx(t,{ref:y,...g,className:F(n,e)})})});at.displayName="AccordionBody";function ln(t,e){const{activeEventKey:n,onSelect:s,alwaysOpen:r}=i.useContext(ue);return a=>{let d=t===n?null:t;r&&(Array.isArray(n)?n.includes(t)?d=n.filter(h=>h!==t):d=[...n,t]:d=[t]),s==null||s(d,a),e==null||e(a)}}const Ue=i.forwardRef(({as:t="button",bsPrefix:e,className:n,onClick:s,...r},a)=>{e=$(e,"accordion-button");const{eventKey:d}=i.useContext(Ce),h=ln(d,s),{activeEventKey:f}=i.useContext(ue);return t==="button"&&(r.type="button"),o.jsx(t,{ref:a,onClick:h,...r,"aria-expanded":Array.isArray(f)?f.includes(d):d===f,className:F(n,e,!rt(f,d)&&"collapsed")})});Ue.displayName="AccordionButton";const it=i.forwardRef(({as:t="h2",bsPrefix:e,className:n,children:s,onClick:r,...a},d)=>(e=$(e,"accordion-header"),o.jsx(t,{ref:d,...a,className:F(n,e),children:o.jsx(Ue,{onClick:r,children:s})})));it.displayName="AccordionHeader";const lt=i.forwardRef(({as:t="div",bsPrefix:e,className:n,eventKey:s,...r},a)=>{e=$(e,"accordion-item");const d=i.useMemo(()=>({eventKey:s}),[s]);return o.jsx(Ce.Provider,{value:d,children:o.jsx(t,{ref:a,...r,className:F(n,e)})})});lt.displayName="AccordionItem";const ct=i.forwardRef((t,e)=>{const{as:n="div",activeKey:s,bsPrefix:r,className:a,onSelect:d,flush:h,alwaysOpen:f,...g}=Ft(t,{activeKey:"onSelect"}),y=$(r,"accordion"),C=i.useMemo(()=>({activeEventKey:s,onSelect:d,alwaysOpen:f}),[s,d,f]);return o.jsx(ue.Provider,{value:C,children:o.jsx(n,{ref:e,...g,className:F(a,y,h&&`${y}-flush`)})})});ct.displayName="Accordion";const me=Object.assign(ct,{Button:Ue,Collapse:Le,Item:lt,Header:it,Body:at}),cn={"aria-label":Se.string,onClick:Se.func,variant:Se.oneOf(["white"])},$e=i.forwardRef(({className:t,variant:e,"aria-label":n="Close",...s},r)=>o.jsx("button",{ref:r,type:"button",className:F("btn-close",e&&`btn-close-${e}`,t),"aria-label":n,...s}));$e.displayName="CloseButton";$e.propTypes=cn;var ge;function Ge(t){if((!ge&&ge!==0||t)&&Be){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),ge=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return ge}function ke(t){t===void 0&&(t=Ze());try{var e=t.activeElement;return!e||!e.nodeName?null:e}catch{return t.body}}function dn(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}const Xe=Bt("modal-open");class De{constructor({ownerDocument:e,handleContainerOverflow:n=!0,isRTL:s=!1}={}){this.handleContainerOverflow=n,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return dn(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const n={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[s]:r.style[s]},e.scrollBarWidth&&(n[s]=`${parseInt(Y(r,s)||"0",10)+e.scrollBarWidth}px`),r.setAttribute(Xe,""),Y(r,n)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const n=this.getElement();n.removeAttribute(Xe),Object.assign(n.style,e.style)}add(e){let n=this.modals.indexOf(e);return n!==-1||(n=this.modals.length,this.modals.push(e),this.setModalAttributes(e),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(e){const n=this.modals.indexOf(e);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const un=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function fn(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}let Oe;function hn(t){return Oe||(Oe=new De({ownerDocument:t==null?void 0:t.document})),Oe}function pn(t){const e=et(),n=t||hn(e),s=i.useRef({dialog:null,backdrop:null});return Object.assign(s.current,{add:()=>n.add(s.current),remove:()=>n.remove(s.current),isTopModal:()=>n.isTopModal(s.current),setDialogRef:i.useCallback(r=>{s.current.dialog=r},[]),setBackdropRef:i.useCallback(r=>{s.current.backdrop=r},[])})}const dt=i.forwardRef((t,e)=>{let{show:n=!1,role:s="dialog",className:r,style:a,children:d,backdrop:h=!0,keyboard:f=!0,onBackdropClick:g,onEscapeKeyDown:y,transition:C,runTransition:j,backdropTransition:x,runBackdropTransition:m,autoFocus:N=!0,enforceFocus:l=!0,restoreFocus:p=!0,restoreFocusOptions:E,renderDialog:S,renderBackdrop:B=_=>o.jsx("div",Object.assign({},_)),manager:T,container:w,onShow:v,onHide:O=()=>{},onExit:M,onExited:k,onExiting:L,onEnter:R,onEntering:z,onEntered:X}=t,Q=fn(t,un);const D=et(),u=Zt(w),c=pn(T),A=Lt(),H=Ut(n),[W,V]=i.useState(!n),U=i.useRef(null);i.useImperativeHandle(e,()=>c,[c]),Be&&!H&&n&&(U.current=ke(D==null?void 0:D.document)),n&&W&&V(!1);const I=G(()=>{if(c.add(),J.current=We(document,"keydown",Ne),re.current=We(document,"focus",()=>setTimeout(_e),!0),v&&v(),N){var _,pe;const ie=ke((_=(pe=c.dialog)==null?void 0:pe.ownerDocument)!=null?_:D==null?void 0:D.document);c.dialog&&ie&&!He(c.dialog,ie)&&(U.current=ie,c.dialog.focus())}}),se=G(()=>{if(c.remove(),J.current==null||J.current(),re.current==null||re.current(),p){var _;(_=U.current)==null||_.focus==null||_.focus(E),U.current=null}});i.useEffect(()=>{!n||!u||I()},[n,u,I]),i.useEffect(()=>{W&&se()},[W,se]),st(()=>{se()});const _e=G(()=>{if(!l||!A()||!c.isTopModal())return;const _=ke(D==null?void 0:D.document);c.dialog&&_&&!He(c.dialog,_)&&c.dialog.focus()}),fe=G(_=>{_.target===_.currentTarget&&(g==null||g(_),h===!0&&O())}),Ne=G(_=>{f&&en(_)&&c.isTopModal()&&(y==null||y(_),_.defaultPrevented||O())}),re=i.useRef(),J=i.useRef(),he=(..._)=>{V(!0),k==null||k(..._)};if(!u)return null;const Z=Object.assign({role:s,ref:c.setDialogRef,"aria-modal":s==="dialog"?!0:void 0},Q,{style:a,className:r,tabIndex:-1});let ae=S?S(Z):o.jsx("div",Object.assign({},Z,{children:i.cloneElement(d,{role:"document"})}));ae=Ke(C,j,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:M,onExiting:L,onExited:he,onEnter:R,onEntering:z,onEntered:X,children:ae});let ee=null;return h&&(ee=B({ref:c.setBackdropRef,onClick:fe}),ee=Ke(x,m,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:ee})),o.jsx(o.Fragment,{children:$t.createPortal(o.jsxs(o.Fragment,{children:[ee,ae]}),u)})});dt.displayName="Modal";const mn=Object.assign(dt,{Manager:De});function gn(t,e){t.classList?t.classList.add(e):tn(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function Ye(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function xn(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=Ye(t.className,e):t.setAttribute("class",Ye(t.className&&t.className.baseVal||"",e))}const oe={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class yn extends De{adjustAndStore(e,n,s){const r=n.style[e];n.dataset[e]=r,Y(n,{[e]:`${parseFloat(Y(n,e))+s}px`})}restore(e,n){const s=n.dataset[e];s!==void 0&&(delete n.dataset[e],Y(n,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const n=this.getElement();if(gn(n,"modal-open"),!e.scrollBarWidth)return;const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";ne(n,oe.FIXED_CONTENT).forEach(a=>this.adjustAndStore(s,a,e.scrollBarWidth)),ne(n,oe.STICKY_CONTENT).forEach(a=>this.adjustAndStore(r,a,-e.scrollBarWidth)),ne(n,oe.NAVBAR_TOGGLER).forEach(a=>this.adjustAndStore(r,a,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const n=this.getElement();xn(n,"modal-open");const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";ne(n,oe.FIXED_CONTENT).forEach(a=>this.restore(s,a)),ne(n,oe.STICKY_CONTENT).forEach(a=>this.restore(r,a)),ne(n,oe.NAVBAR_TOGGLER).forEach(a=>this.restore(r,a))}}let Re;function vn(t){return Re||(Re=new yn(t)),Re}const ut=i.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=$(e,"modal-body"),o.jsx(n,{ref:r,className:F(t,e),...s})));ut.displayName="ModalBody";const ft=i.createContext({onHide(){}}),Ie=i.forwardRef(({bsPrefix:t,className:e,contentClassName:n,centered:s,size:r,fullscreen:a,children:d,scrollable:h,...f},g)=>{t=$(t,"modal");const y=`${t}-dialog`,C=typeof a=="string"?`${t}-fullscreen-${a}`:`${t}-fullscreen`;return o.jsx("div",{...f,ref:g,className:F(y,e,r&&`${t}-${r}`,s&&`${y}-centered`,h&&`${y}-scrollable`,a&&C),children:o.jsx("div",{className:F(`${t}-content`,n),children:d})})});Ie.displayName="ModalDialog";const ht=i.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=$(e,"modal-footer"),o.jsx(n,{ref:r,className:F(t,e),...s})));ht.displayName="ModalFooter";const bn=i.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:n=!1,onHide:s,children:r,...a},d)=>{const h=i.useContext(ft),f=G(()=>{h==null||h.onHide(),s==null||s()});return o.jsxs("div",{ref:d,...a,children:[r,n&&o.jsx($e,{"aria-label":t,variant:e,onClick:f})]})}),pt=i.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:s=!1,...r},a)=>(t=$(t,"modal-header"),o.jsx(bn,{ref:a,...r,className:F(e,t),closeLabel:n,closeButton:s})));pt.displayName="ModalHeader";const wn=Dt("h4"),mt=i.forwardRef(({className:t,bsPrefix:e,as:n=wn,...s},r)=>(e=$(e,"modal-title"),o.jsx(n,{ref:r,className:F(t,e),...s})));mt.displayName="ModalTitle";function jn(t){return o.jsx(tt,{...t,timeout:null})}function En(t){return o.jsx(tt,{...t,timeout:null})}const gt=i.forwardRef(({bsPrefix:t,className:e,style:n,dialogClassName:s,contentClassName:r,children:a,dialogAs:d=Ie,"data-bs-theme":h,"aria-labelledby":f,"aria-describedby":g,"aria-label":y,show:C=!1,animation:j=!0,backdrop:x=!0,keyboard:m=!0,onEscapeKeyDown:N,onShow:l,onHide:p,container:E,autoFocus:S=!0,enforceFocus:B=!0,restoreFocus:T=!0,restoreFocusOptions:w,onEntered:v,onExit:O,onExiting:M,onEnter:k,onEntering:L,onExited:R,backdropClassName:z,manager:X,...Q},D)=>{const[u,c]=i.useState({}),[A,H]=i.useState(!1),W=i.useRef(!1),V=i.useRef(!1),U=i.useRef(null),[I,se]=It(),_e=Pt(D,se),fe=G(p),Ne=zt();t=$(t,"modal");const re=i.useMemo(()=>({onHide:fe}),[fe]);function J(){return X||vn({isRTL:Ne})}function he(b){if(!Be)return;const te=J().getScrollbarWidth()>0,ze=b.scrollHeight>Ze(b).documentElement.clientHeight;c({paddingRight:te&&!ze?Ge():void 0,paddingLeft:!te&&ze?Ge():void 0})}const Z=G(()=>{I&&he(I.dialog)});st(()=>{Ve(window,"resize",Z),U.current==null||U.current()});const ae=()=>{W.current=!0},ee=b=>{W.current&&I&&b.target===I.dialog&&(V.current=!0),W.current=!1},_=()=>{H(!0),U.current=Ht(I.dialog,()=>{H(!1)})},pe=b=>{b.target===b.currentTarget&&_()},ie=b=>{if(x==="static"){pe(b);return}if(V.current||b.target!==b.currentTarget){V.current=!1;return}p==null||p()},bt=b=>{m?N==null||N(b):(b.preventDefault(),x==="static"&&_())},wt=(b,te)=>{b&&he(b),k==null||k(b,te)},jt=b=>{U.current==null||U.current(),O==null||O(b)},Et=(b,te)=>{L==null||L(b,te),Wt(window,"resize",Z)},Ct=b=>{b&&(b.style.display=""),R==null||R(b),Ve(window,"resize",Z)},_t=i.useCallback(b=>o.jsx("div",{...b,className:F(`${t}-backdrop`,z,!j&&"show")}),[j,z,t]),Pe={...n,...u};Pe.display="block";const Nt=b=>o.jsx("div",{role:"dialog",...b,style:Pe,className:F(e,t,A&&`${t}-static`,!j&&"show"),onClick:x?ie:void 0,onMouseUp:ee,"data-bs-theme":h,"aria-label":y,"aria-labelledby":f,"aria-describedby":g,children:o.jsx(d,{...Q,onMouseDown:ae,className:s,contentClassName:r,children:a})});return o.jsx(ft.Provider,{value:re,children:o.jsx(mn,{show:C,ref:_e,backdrop:x,container:E,keyboard:!0,autoFocus:S,enforceFocus:B,restoreFocus:T,restoreFocusOptions:w,onEscapeKeyDown:bt,onShow:l,onHide:p,onEnter:wt,onEntering:Et,onEntered:v,onExit:jt,onExiting:M,onExited:Ct,manager:J(),transition:j?jn:void 0,backdropTransition:j?En:void 0,renderBackdrop:_t,renderDialog:Nt})})});gt.displayName="Modal";const ce=Object.assign(gt,{Body:ut,Header:pt,Title:mt,Footer:ht,Dialog:Ie,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),Cn={"category-selector":"_category-selector_1aq5o_1"},_n={nc:"Norm-conserving",us:"Ultrasoft",paw:"PAW"},Nn=({categories:t,activeCategories:e,onCategorySelect:n})=>o.jsx("div",{className:Cn["category-selector"],children:t.map(s=>o.jsx(Qt.Check,{type:"checkbox",id:`category-${s}`,label:_n[s]||s,checked:e.includes(s),onChange:r=>r.target.checked?n([...e,s]):n(e.filter(a=>a!==s))},s))}),Te={"convergence-summary-header":"_convergence-summary-header_1ed6f_1","convergence-plot-container":"_convergence-plot-container_1ed6f_1","convergence-plot-details-container":"_convergence-plot-details-container_1ed6f_1"},Sn={"convergence-plot":"_convergence-plot_b9eda_1"};var xt={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Qe=K.createContext&&K.createContext(xt),kn=["attr","size","title"];function On(t,e){if(t==null)return{};var n=Rn(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Rn(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function je(){return je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},je.apply(this,arguments)}function Je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Je(Object(n),!0).forEach(function(s){Tn(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Tn(t,e,n){return e=Mn(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mn(t){var e=An(t,"string");return typeof e=="symbol"?e:e+""}function An(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yt(t){return t&&t.map((e,n)=>K.createElement(e.tag,Ee({key:n},e.attr),yt(e.child)))}function Fn(t){return e=>K.createElement(Bn,je({attr:Ee({},t.attr)},e),yt(t.child))}function Bn(t){var e=n=>{var{attr:s,size:r,title:a}=t,d=On(t,kn),h=r||n.size||"1em",f;return n.className&&(f=n.className),t.className&&(f=(f?f+" ":"")+t.className),K.createElement("svg",je({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,d,{className:f,style:Ee(Ee({color:t.color||n.color},n.style),t.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),a&&K.createElement("title",null,a),t.children)};return Qe!==void 0?K.createElement(Qe.Consumer,null,n=>e(n)):e(xt)}function Ln(t){return Fn({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"},child:[]},{tag:"path",attr:{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"},child:[]}]})(t)}const Un="_modalBody_f8cvt_1",$n="_content_f8cvt_5",Dn="_pre_f8cvt_12",In="_loadContainer_f8cvt_20",Pn="_hint_f8cvt_30",zn="_message_f8cvt_34",Wn="_filename_f8cvt_1",Hn="_downloadUpfText_f8cvt_1",Vn="_downloadUpfButton_f8cvt_1",P={modalBody:Un,content:$n,pre:Dn,loadContainer:In,hint:Pn,message:zn,filename:Wn,downloadUpfText:Hn,downloadUpfButton:Vn},qn=({show:t,element:e,pseudoName:n,Z:s,onHide:r})=>{const{getUpfUuid:a,getPseudoFilename:d}=i.useContext(nt),[h,f]=i.useState(""),[g,y]=i.useState(""),[C,j]=i.useState(!1),[x,m]=i.useState(!1),[N,l]=i.useState(null),p=!!Vt,E=i.useMemo(()=>!e||!n||s===void 0?"":a(e,n,s),[e,n,s,a]),S=i.useMemo(()=>!e||!n||s===void 0?"":d(e,n,s),[e,n,s,d]);i.useEffect(()=>{t&&(l(null),f(""),j(!1),m(!1),y(S||""))},[t,e,n,s,S]);const B=async()=>{if(l(null),!p){l("UPF viewer is unavailable (VITE_API_URL is not set)");return}if(!n||s===void 0){l("No pseudopotential selected");return}if(!E){l("No UPF UUID found for this pseudopotential");return}j(!0);try{const{filename:v,content:O}=await Fe.fetchUpfFile(E);y(M=>M||v),f(O)}catch(v){l((v==null?void 0:v.message)||"Failed to load UPF file")}finally{j(!1)}},T=async()=>{if(l(null),!p){l("UPF download is unavailable (VITE_API_URL is not set)");return}if(!E){l("No UPF UUID found for this pseudopotential");return}m(!0);try{const{filename:v,blob:O}=await Fe.fetchUpfBlob(E),M=URL.createObjectURL(O),k=document.createElement("a");k.href=M;const L=`${e}-${n||"pseudo"}${s!==void 0?`-Z${s}`:""}.upf`;k.download=g||v||L,document.body.appendChild(k),k.click(),k.remove(),URL.revokeObjectURL(M)}catch(v){l((v==null?void 0:v.message)||"Failed to download UPF file")}finally{m(!1)}},w=!p||!E;return o.jsxs(ce,{show:t,onHide:r,size:"xl",centered:!0,scrollable:!0,children:[o.jsx(ce.Header,{closeButton:!0,children:o.jsxs(ce.Title,{children:[e," (Z",o.jsx("sub",{children:"val"})," = ",s,") ",n]})}),o.jsx(ce.Body,{className:P.modalBody,children:N?o.jsx("div",{className:P.message,children:N}):C?o.jsx(ot,{}):h?o.jsx("div",{className:P.content,children:o.jsx("pre",{className:P.pre,children:h})}):p?E?o.jsxs("div",{className:P.loadContainer,children:[o.jsx(qe,{variant:"primary",onClick:B,children:"Load UPF content"}),o.jsx("div",{className:P.hint,children:"May take some time"})]}):o.jsx("div",{className:P.message,children:"No UPF UUID found for this pseudopotential."}):o.jsx("div",{className:P.message,children:"Backend not configured. UPF download/viewing is unavailable."})}),o.jsxs(ce.Footer,{className:"justify-content-start",children:[o.jsxs(qe,{id:P.downloadUpfButton,variant:"primary",onClick:T,disabled:w||x,children:[o.jsx("span",{id:P.downloadUpfText,children:"Download UPF file"}),x?o.jsx("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:o.jsx("span",{className:"visually-hidden",children:"Loading..."})}):o.jsx(Ln,{})]}),o.jsx("span",{id:P.filename,children:g})]})]})},Me=1.2,Ae=1.3,xe=.13,vt=6,de=1,q=10,Kn=40,Gn=80,ye=2,ve=8,Xn=120,Yn=new Set(["O","Fe","Mn","Hf","Co","Ni","Cr"]),Qn=.2,Jn=2,Zn=1,eo=["δω","δV<sub>press</sub>","δE<sub>coh</sub>","δν"],to=["circle","triangle-down","star","square"],no=["solid","dash","dot","solid"],be={phononFrequencies:{label:"δω",symbol:"circle",dash:"solid"},pressure:{label:"δV<sub>press</sub>",symbol:"triangle-down",dash:"dash"},cohesiveEnergy:{label:"δE<sub>coh</sub>",symbol:"star",dash:"dot"},eos:{label:"δν",symbol:"square",dash:"solid"}},oo=(t,e,n,s,r)=>{const a=ve/4,d=s.map((x,m)=>m*ve),h=s.length*Xn+(Kn+Gn),f=Yn.has(t)?18:8,g=[],y=[],C=[];s.forEach((x,m)=>{var Q,D;const N=((Q=r[x.name])==null?void 0:Q.color)||"black",l=m*ve,{quantities:p}=x;let E=[],S=[],B=[],T=[],w=[],v=[],O=[];if(p.phononFrequencies){E=p.phononFrequencies.values.map(A=>A*2/Jn);let u=we(be.phononFrequencies,N);u.x=p.phononFrequencies.cutoffs,u.y=E.map(A=>A+l),S=p.phononFrequencies.error,u.error_y={type:"data",array:S,arrayminus:E.map(()=>0),visible:!0,color:N},g.push(u);const c=p.phononFrequencies.ref.toFixed(2);y.push({x:203.1,y:l-1,text:`ω<sub>max</sub> = ${c} cm<sup>-1</sup>`,showarrow:!1,font:{size:q}})}if(p.pressure){let u=we(be.pressure,N);B=p.pressure.values.map(c=>c*2/Zn),u.x=p.pressure.cutoffs,u.y=B.map(c=>c+l),g.push(u)}if(p.cohesiveEnergy){let u=we(be.cohesiveEnergy,N);T=p.cohesiveEnergy.values,u.x=p.cohesiveEnergy.cutoffs,u.y=T.map(A=>A+l),g.push(u);const c=p.cohesiveEnergy.ref.toFixed(2);y.push({x:205,y:l+1,text:`E<sub>coh</sub> = ${c} <i>meV/atom</i>`,showarrow:!1,font:{size:q}})}if(p.eos){let u=we(be.eos,N);w=p.eos.values.map(c=>c*2/Qn),u.x=p.eos.cutoffs,u.y=w.map(c=>c+l),g.push(u)}if(p.bands){const u=p.bands.cutoffs;v=p.bands.eta_c,O=p.bands.max_diff_c,y.push({x:24,y:l+Me*a+xe,text:"       <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:q}}),g.push({x:u,y:v.map(()=>l+Me*a),type:"scatter",mode:"text",text:v.map(c=>c>=100?c.toExponential(0).toString().replace("e+","e"):c.toFixed(2)),showlegend:!1,textfont:{size:q},hoverinfo:"skip"}),y.push({x:205,y:l+Me*a+xe,text:"[meV]",showarrow:!1,align:"left",font:{size:q}}),g.push({x:[0,250],y:[l+a,l+a],type:"scatter",mode:"lines",text:v.map(c=>c.toFixed(2)),showlegend:!1,line:{color:N,width:de,dash:"dashdot"},hoverinfo:"skip"}),g.push({x:[0,250],y:[l+a/2,l+a/2],type:"scatter",mode:"lines",text:v.map(c=>c.toFixed(2)),showlegend:!1,line:{color:"lightgray",width:de,dash:"dot"},hoverinfo:"skip"}),y.push({x:24,y:l-Ae*a+xe,text:"max <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:q}}),g.push({x:u,y:O.map(()=>l-Ae*a),type:"scatter",mode:"text",text:O.map(c=>c>=100?c.toExponential(0).toString().replace("e+","e"):c.toFixed(2)),showlegend:!1,textfont:{size:q},hoverinfo:"skip"}),y.push({x:205,y:l-Ae*a+xe,text:"[meV]",showarrow:!1,align:"left",font:{size:q}}),g.push({x:[0,250],y:[l-a,l-a],type:"scatter",mode:"lines",text:O.map(c=>c.toFixed(2)),showlegend:!1,line:{color:N,width:de,dash:"dashdot"},hoverinfo:"skip"})}C.push({type:"line",x0:18,x1:216,y0:l,y1:l,opacity:.25,line:{width:.5}});const M=((D=x.quantities.bands)==null?void 0:D.cutoffs)||[],k=[M],L=["E<sub>wfc</sub> = %{customdata[0]} Ry"];let R=1;if(E.length){k.push(E);let u=`<br />δω = %{customdata[${R}]:.3f}`;R+=1,S.length&&(k.push(S),u+=` &plusmn; %{customdata[${R}]:.1e}`,R+=1),u+="%",L.push(u)}B.length&&(k.push(B),L.push(`<br />δV<sub>press</sub> = %{customdata[${R}]:.3f}%`),R+=1),T.length&&(k.push(T),L.push(`<br />δE<sub>coh</sub> = %{customdata[${R}]:.3f} meV`),R+=1),w.length&&(k.push(w),L.push(`<br />δv = %{customdata[${R}]:.3f}`),R+=1),v.length&&(k.push(v),L.push(`<br />η<sub>10</sub> = %{customdata[${R}]:.3f} meV`),R+=1),O.length&&(k.push(O),L.push(`<br />max η<sub>10</sub> = %{customdata[${R}]:.3f} meV`),R+=1),g.push({x:M,y:new Array(M.length).fill(l),mode:"markers",marker:{size:24,opacity:0,line:{width:0}},showlegend:!1,customdata:M.map((u,c)=>k.map(A=>A[c])),hoverlabel:{bgcolor:"rgb(225, 225, 225)",bordercolor:"black"},hovertemplate:`<b>${x.name}</b><br />`+L.join("")+"<extra></extra>"});const{metadata:z}=x.quantities;let X="not all EOS valid";if(z){const u=z.avg_nu.toFixed(2),c=z.max_nu.toFixed(2),A=nn(z.max_conf),H=z.avg_nu_wo_max.toFixed(2);X=`ν<sub>avg</sub> = ${u}<br />ν<sub>max</sub> = ${c} (${A})<br />ν<sub>avg</sub> (w/o max) = ${H}`}y.push({xref:"paper",x:-.1,y:l,text:`<span style="color:#0d6efd"><b>${x.name}</b></span><br />Z<sub>val</sub> = ${x.Z}<br />${X}`,showarrow:!1,align:"left",font:{size:10},captureevents:!0}),e.forEach(u=>{if(n[u].pseudopotential===x.name&&n[u].Z===x.Z){const c=n[u].cutoff_wfc;if(u==="efficiency")C.push({type:"rect",x0:c-ye,x1:c+ye,y0:d[m]-a,y1:d[m]+a,fillcolor:"lightgreen",line:{width:1,color:"green"},opacity:.5});else{const A=c-ye,H=c+ye,W=d[m]-a,V=d[m]+a,U=(A+H)/2,I=(W+V)/2;C.push({type:"path",path:`M ${U} ${V} L ${H} ${I} L ${U} ${W} L ${A} ${I} Z`,fillcolor:"lightcoral",line:{width:1,color:"darkred"},opacity:.5})}}})}),eo.forEach((x,m)=>{g.push({name:x,type:"scatter",mode:"lines+markers",x:[NaN],y:[NaN],line:{color:"black",width:de,dash:no[m]},marker:{size:vt,symbol:to[m]},showlegend:!0,legendgroup:x,hoverinfo:"skip"})});const j={xaxis:{title:{text:`Wavefunction cutoff [Ry]; Charge density cutoff [Ry] = ${f} x Ewfc (PAW/US) | 4 x Ewfc (NC); q-point = [0.5, 0.5, 0.5]`},showgrid:!1,showline:!0,mirror:!0,tickvals:[...Array.from({length:18},(x,m)=>m*10+30)],ticks:"inside",ticklen:5,range:[18,216],fixedrange:!0},yaxis:{side:"right",title:{text:"Error w.r.t. ref. wavefunction cutoff"},zeroline:!1,showgrid:!1,showline:!0,mirror:!0,ticks:"inside",ticklen:5,tickmode:"array",tickvals:d,ticktext:d.map(()=>"0"),range:[-5,(s.length-1)*ve+5],fixedrange:!0},showlegend:!0,legend:{x:1.05,y:1,xanchor:"left",yanchor:"top",font:{size:q,color:"black"},bordercolor:"lightgrey",borderwidth:1},annotations:y,shapes:C,hovermode:"closest",height:h,margin:{l:160,r:80,t:10,b:70}};return{data:g,layout:j}},we=(t,e)=>({name:t.label,type:"scatter",mode:"lines+markers",line:{color:e,width:de,dash:t.dash},marker:{size:vt,symbol:t.symbol},showlegend:!1,legendgroup:t.label,hoverinfo:"skip"}),so={responsive:!0,displayModeBar:!1,displaylogo:!1},ro=({element:t,summaryData:e,pseudosMetadata:n})=>{const{libraries:s}=i.useContext(qt),{elementsInfo:r}=i.useContext(Kt),[a,d]=i.useState(!1),[h,f]=i.useState(""),[g,y]=i.useState(),C=i.useRef(null),j=i.useMemo(()=>!e||!e.pseudos?[]:e.pseudos.filter(m=>n.hasOwnProperty(m.name)).reverse(),[e==null?void 0:e.pseudos,n]),x=i.useMemo(()=>Object.fromEntries(Object.entries(r).map(([m,N])=>[m,N[t]])),[r,t]);return i.useEffect(()=>{if(!j.length||!C.current)return;let m=!1;return(async()=>{const N=(await Gt(async()=>{const{default:S}=await import("./PlotlyLoader-Dfl3qsnW.js");return{default:S}},__vite__mapDeps([0,1,2,3]))).default;if(m||!C.current)return;const{data:l,layout:p}=oo(t,s,x,j,n);await N.react(C.current,l,p,so);const E=C.current;E!=null&&E.removeAllListeners&&E.removeAllListeners("plotly_clickannotation"),E!=null&&E.on&&E.on("plotly_clickannotation",async S=>{var M;const B=((M=S==null?void 0:S.annotation)==null?void 0:M.text)||"",T=B.match(/<b>(.*?)<\/b>/),w=T==null?void 0:T[1];if(!w)return;const v=B.match(/Z<sub>val<\/sub>\s*=\s*(\d+)/),O=v?Number.parseInt(v[1],10):NaN;Number.isFinite(O)&&(f(w),y(O),d(!0))})})(),()=>{m=!0}},[t,e,s,x,j,n]),j.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:C,id:Sn["convergence-plot"]}),o.jsx(qn,{show:a,element:t,pseudoName:h,Z:g,onHide:()=>d(!1)})]}):o.jsx(Jt,{})},ao={"convergence-plot-legend-table":"_convergence-plot-legend-table_1h1ks_1"},io=()=>o.jsx(me,{children:o.jsxs(me.Item,{eventKey:"0",children:[o.jsx(me.Header,{children:"About the SSSP protocol convergence pattern plots"}),o.jsxs(me.Body,{children:[o.jsxs("section",{children:[o.jsx("p",{children:"We report here the zone-boundary phonons, cohesive energy, pressure, and band structure versus the wavefunction cutoff for all the considered pseudopotential libraries."}),o.jsxs("p",{children:["The colored horizontal dashed lines correspond to the thresholds of the SSSP efficiency criteria, whereas the gray dotted lines correspond to the precision criteria. ",o.jsx("br",{})," The recommended efficiency (precision) pseudopotential is marked with a"," ",o.jsx("span",{style:{color:"green"},children:"rectangle"})," (",o.jsx("span",{style:{color:"red"},children:"diamond"}),") at the recommended cutoff."]})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Metadata"}),"We report on the left of the plot:",o.jsxs("ul",{children:[o.jsx("li",{children:"the number of valence electrons of the pseudopotential"}),o.jsxs("li",{children:["the average of ",o.jsx("b",{children:"ν"}),", a *metric relating to the equation of state, across 10 structures"]}),o.jsxs("li",{children:["the maximum ",o.jsx("b",{children:"ν"})," value"]}),o.jsxs("li",{children:["the average of ",o.jsx("b",{children:"ν"}),", excluding the XO",o.jsx("sub",{children:"3"})," structure"]})]}),o.jsx("p",{children:"Tip: click a pseudopotential label on the left to open its UPF viewer (available when an API backend is configured)."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Legend"}),o.jsxs("p",{children:["Each pseudopotential is represented in its own color. The legend items are kept in black and reflect the corresponding quantity/discrepancy across all pseudopotentials.",o.jsx("br",{}),"The markers correspond to the following quantities:"]}),o.jsxs(Xt,{id:ao["convergence-plot-legend-table"],striped:!0,bordered:!0,responsive:!0,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Marker"}),o.jsx("th",{children:"Quantity"}),o.jsx("th",{children:"Units"}),o.jsx("th",{children:"Description"})]})}),o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("td",{children:"●"}),o.jsx("td",{children:"δω"}),o.jsx("td",{children:"%"}),o.jsx("td",{children:"Discrepancy in all phonon frequencies at the zone boundary"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"▼"}),o.jsxs("td",{children:["δV",o.jsx("sub",{children:"press"})]}),o.jsx("td",{children:"%"}),o.jsx("td",{children:"Discrepancy in pressure"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"★"}),o.jsxs("td",{children:["δE",o.jsx("sub",{children:"coh"})]}),o.jsx("td",{children:"meV"}),o.jsx("td",{children:"Discrepancy in cohesive energy"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"■"}),o.jsx("td",{children:"δν"}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"Discrepancy in equation of state"})]})]})]}),o.jsx("p",{children:"A single click on a legend item toggles its visibility, while a double click isolates it."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Categories"}),o.jsx("p",{children:"You can use the pseudopotential category checkboxes to filter the pseudopotentials shown in the plots."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Additional information"}),o.jsxs("p",{children:["See the ",o.jsx("b",{children:"About"})," tab of the"," ",o.jsx("a",{href:"https://acwf-verification.materialscloud.org/",target:"_blank",style:{textDecoration:"none"},children:"Verification of the precision of DFT implementations via AiiDA common workflows"})," ","app to learn more about how ",o.jsx("b",{children:"ν"})," is computed. ",o.jsx("br",{}),"All calculations are performed on the ground-state elemental solids unless stated otherwise (i.e. rare-earths and flourine). See"," ",o.jsx(Yt,{to:"/about",style:{textDecoration:"none"},children:"About SSSP"})," ","for more details."]})]})]})]})}),fo=({element:t})=>{const[e,n]=i.useState(!0),[s,r]=i.useState({}),{loadingMetadata:a,categories:d,pseudosMetadata:h}=i.useContext(nt),[f,g]=i.useState(d),y=i.useMemo(()=>{const j={};return Object.entries(h).forEach(([x,m])=>{f.includes(m.category)&&(j[x]=m)}),j},[f,h]);return i.useEffect(()=>{t&&(n(!0),r({}),Fe.fetchPseudosSummaryData(t).then(j=>{r(j)}).catch(j=>{console.error("Error fetching data:",j),r({})}).finally(()=>{n(!1)}))},[t]),e||a?o.jsx(ot,{}):o.jsxs("div",{id:"convergence-summary",children:[o.jsxs("div",{id:Te["convergence-summary-header"],children:[o.jsxs("h2",{className:"display-6",children:["Verification summary: ",t," (",s.conff,")"]}),o.jsx(Nn,{categories:d,activeCategories:f,onCategorySelect:g})]}),o.jsx("div",{id:Te["convergence-plot-container"],children:o.jsx(ro,{element:t,summaryData:s,pseudosMetadata:y})}),o.jsx("div",{id:Te["convergence-plot-details-container"],children:o.jsx(io,{})})]})};export{fo as default};
