const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-D3vtWR5M.js","assets/index-D6nKi-EL.js","assets/index-yaOUSvUS.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{R as G,r as i,c as le,j as o,T as Ot,t as Rt,a as F,s as Q,b as St,E as Tt,d as At,e as Mt,f as Ft,u as D,g as Bt,P as ke,h as Fe,o as Ze,i as Ut,k as et,l as $t,m as Lt,n as Y,p as ze,q as We,K as Dt,v as oe,w as It,x as Pt,y as zt,z as Wt,A as He,F as tt,B as Ht,C as Vt,D as nt,L as ot,G as Ve,H as qt,S as qe,I as Kt,J as st,_ as Gt,M as Xt,N as Yt,O as Qt}from"./index-D6nKi-EL.js";import{F as Jt,N as Zt}from"./NoDataMessage-BQfSGjbm.js";import{u as en,a as rt,i as tn,r as Ke,h as nn,f as on}from"./utils-De-UNgX-.js";const sn={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function rn(t,e){const n=`offset${t[0].toUpperCase()}${t.slice(1)}`,s=e[n],r=sn[t];return s+parseInt(Q(e,r[0]),10)+parseInt(Q(e,r[1]),10)}const an={[Ft]:"collapse",[Mt]:"collapsing",[At]:"collapsing",[Tt]:"collapse show"},ln=G.forwardRef(({onEnter:t,onEntering:e,onEntered:n,onExit:s,onExiting:r,className:a,children:c,dimension:f="height",in:h=!1,timeout:x=300,mountOnEnter:p=!1,unmountOnExit:E=!1,appear:_=!1,getDimensionValue:y=rn,...v},N)=>{const l=typeof f=="function"?f():f,u=i.useMemo(()=>le(j=>{j.style[l]="0"},t),[l,t]),k=i.useMemo(()=>le(j=>{const m=`scroll${l[0].toUpperCase()}${l.slice(1)}`;j.style[l]=`${j[m]}px`},e),[l,e]),M=i.useMemo(()=>le(j=>{j.style[l]=null},n),[l,n]),O=i.useMemo(()=>le(j=>{j.style[l]=`${y(l,j)}px`,St(j)},s),[s,y,l]),B=i.useMemo(()=>le(j=>{j.style[l]=null},r),[l,r]);return o.jsx(Ot,{ref:N,addEndListener:Rt,...v,"aria-expanded":v.role?h:null,onEnter:u,onEntering:k,onEntered:M,onExit:O,onExiting:B,childRef:c.ref,in:h,timeout:x,mountOnEnter:p,unmountOnExit:E,appear:_,children:(j,m)=>G.cloneElement(c,{...m,className:F(a,c.props.className,an[j],l==="width"&&"collapse-horizontal")})})});function at(t,e){return Array.isArray(t)?t.includes(e):t===e}const ue=i.createContext({});ue.displayName="AccordionContext";const Be=i.forwardRef(({as:t="div",bsPrefix:e,className:n,children:s,eventKey:r,...a},c)=>{const{activeEventKey:f}=i.useContext(ue);return e=D(e,"accordion-collapse"),o.jsx(ln,{ref:c,in:at(f,r),...a,className:F(n,e),children:o.jsx(t,{children:i.Children.only(s)})})});Be.displayName="AccordionCollapse";const Ce=i.createContext({eventKey:""});Ce.displayName="AccordionItemContext";const it=i.forwardRef(({as:t="div",bsPrefix:e,className:n,onEnter:s,onEntering:r,onEntered:a,onExit:c,onExiting:f,onExited:h,...x},p)=>{e=D(e,"accordion-body");const{eventKey:E}=i.useContext(Ce);return o.jsx(Be,{eventKey:E,onEnter:s,onEntering:r,onEntered:a,onExit:c,onExiting:f,onExited:h,children:o.jsx(t,{ref:p,...x,className:F(n,e)})})});it.displayName="AccordionBody";function cn(t,e){const{activeEventKey:n,onSelect:s,alwaysOpen:r}=i.useContext(ue);return a=>{let c=t===n?null:t;r&&(Array.isArray(n)?n.includes(t)?c=n.filter(f=>f!==t):c=[...n,t]:c=[t]),s==null||s(c,a),e==null||e(a)}}const Ue=i.forwardRef(({as:t="button",bsPrefix:e,className:n,onClick:s,...r},a)=>{e=D(e,"accordion-button");const{eventKey:c}=i.useContext(Ce),f=cn(c,s),{activeEventKey:h}=i.useContext(ue);return t==="button"&&(r.type="button"),o.jsx(t,{ref:a,onClick:f,...r,"aria-expanded":Array.isArray(h)?h.includes(c):c===h,className:F(n,e,!at(h,c)&&"collapsed")})});Ue.displayName="AccordionButton";const lt=i.forwardRef(({as:t="h2",bsPrefix:e,className:n,children:s,onClick:r,...a},c)=>(e=D(e,"accordion-header"),o.jsx(t,{ref:c,...a,className:F(n,e),children:o.jsx(Ue,{onClick:r,children:s})})));lt.displayName="AccordionHeader";const ct=i.forwardRef(({as:t="div",bsPrefix:e,className:n,eventKey:s,...r},a)=>{e=D(e,"accordion-item");const c=i.useMemo(()=>({eventKey:s}),[s]);return o.jsx(Ce.Provider,{value:c,children:o.jsx(t,{ref:a,...r,className:F(n,e)})})});ct.displayName="AccordionItem";const dt=i.forwardRef((t,e)=>{const{as:n="div",activeKey:s,bsPrefix:r,className:a,onSelect:c,flush:f,alwaysOpen:h,...x}=Bt(t,{activeKey:"onSelect"}),p=D(r,"accordion"),E=i.useMemo(()=>({activeEventKey:s,onSelect:c,alwaysOpen:h}),[s,c,h]);return o.jsx(ue.Provider,{value:E,children:o.jsx(n,{ref:e,...x,className:F(a,p,f&&`${p}-flush`)})})});dt.displayName="Accordion";const me=Object.assign(dt,{Button:Ue,Collapse:Be,Item:ct,Header:lt,Body:it}),dn={"aria-label":ke.string,onClick:ke.func,variant:ke.oneOf(["white"])},$e=i.forwardRef(({className:t,variant:e,"aria-label":n="Close",...s},r)=>o.jsx("button",{ref:r,type:"button",className:F("btn-close",e&&`btn-close-${e}`,t),"aria-label":n,...s}));$e.displayName="CloseButton";$e.propTypes=dn;var ge;function Ge(t){if((!ge&&ge!==0||t)&&Fe){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),ge=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return ge}function Oe(t){t===void 0&&(t=Ze());try{var e=t.activeElement;return!e||!e.nodeName?null:e}catch{return t.body}}function un(t=document){const e=t.defaultView;return Math.abs(e.innerWidth-t.documentElement.clientWidth)}const Xe=Ut("modal-open");class Le{constructor({ownerDocument:e,handleContainerOverflow:n=!0,isRTL:s=!1}={}){this.handleContainerOverflow=n,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return un(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const n={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[s]:r.style[s]},e.scrollBarWidth&&(n[s]=`${parseInt(Q(r,s)||"0",10)+e.scrollBarWidth}px`),r.setAttribute(Xe,""),Q(r,n)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const n=this.getElement();n.removeAttribute(Xe),Object.assign(n.style,e.style)}add(e){let n=this.modals.indexOf(e);return n!==-1||(n=this.modals.length,this.modals.push(e),this.setModalAttributes(e),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(e){const n=this.modals.indexOf(e);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const fn=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function hn(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}let Re;function pn(t){return Re||(Re=new Le({ownerDocument:t==null?void 0:t.document})),Re}function mn(t){const e=et(),n=t||pn(e),s=i.useRef({dialog:null,backdrop:null});return Object.assign(s.current,{add:()=>n.add(s.current),remove:()=>n.remove(s.current),isTopModal:()=>n.isTopModal(s.current),setDialogRef:i.useCallback(r=>{s.current.dialog=r},[]),setBackdropRef:i.useCallback(r=>{s.current.backdrop=r},[])})}const ut=i.forwardRef((t,e)=>{let{show:n=!1,role:s="dialog",className:r,style:a,children:c,backdrop:f=!0,keyboard:h=!0,onBackdropClick:x,onEscapeKeyDown:p,transition:E,runTransition:_,backdropTransition:y,runBackdropTransition:v,autoFocus:N=!0,enforceFocus:l=!0,restoreFocus:u=!0,restoreFocusOptions:k,renderDialog:M,renderBackdrop:O=C=>o.jsx("div",Object.assign({},C)),manager:B,container:j,onShow:m,onHide:R=()=>{},onExit:w,onExited:S,onExiting:A,onEnter:$,onEntering:T,onEntered:H}=t,J=hn(t,fn);const I=et(),V=en(j),d=mn(B),g=$t(),P=Lt(n),[L,q]=i.useState(!n),U=i.useRef(null);i.useImperativeHandle(e,()=>d,[d]),Fe&&!P&&n&&(U.current=Oe(I==null?void 0:I.document)),n&&L&&q(!1);const z=Y(()=>{if(d.add(),Z.current=ze(document,"keydown",Ne),re.current=ze(document,"focus",()=>setTimeout(_e),!0),m&&m(),N){var C,pe;const ie=Oe((C=(pe=d.dialog)==null?void 0:pe.ownerDocument)!=null?C:I==null?void 0:I.document);d.dialog&&ie&&!We(d.dialog,ie)&&(U.current=ie,d.dialog.focus())}}),X=Y(()=>{if(d.remove(),Z.current==null||Z.current(),re.current==null||re.current(),u){var C;(C=U.current)==null||C.focus==null||C.focus(k),U.current=null}});i.useEffect(()=>{!n||!V||z()},[n,V,z]),i.useEffect(()=>{L&&X()},[L,X]),rt(()=>{X()});const _e=Y(()=>{if(!l||!g()||!d.isTopModal())return;const C=Oe(I==null?void 0:I.document);d.dialog&&C&&!We(d.dialog,C)&&d.dialog.focus()}),fe=Y(C=>{C.target===C.currentTarget&&(x==null||x(C),f===!0&&R())}),Ne=Y(C=>{h&&tn(C)&&d.isTopModal()&&(p==null||p(C),C.defaultPrevented||R())}),re=i.useRef(),Z=i.useRef(),he=(...C)=>{q(!0),S==null||S(...C)};if(!V)return null;const ee=Object.assign({role:s,ref:d.setDialogRef,"aria-modal":s==="dialog"?!0:void 0},J,{style:a,className:r,tabIndex:-1});let ae=M?M(ee):o.jsx("div",Object.assign({},ee,{children:i.cloneElement(c,{role:"document"})}));ae=Ke(E,_,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:w,onExiting:A,onExited:he,onEnter:$,onEntering:T,onEntered:H,children:ae});let te=null;return f&&(te=O({ref:d.setBackdropRef,onClick:fe}),te=Ke(y,v,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:te})),o.jsx(o.Fragment,{children:Dt.createPortal(o.jsxs(o.Fragment,{children:[te,ae]}),V)})});ut.displayName="Modal";const gn=Object.assign(ut,{Manager:Le});function xn(t,e){t.classList?t.classList.add(e):nn(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function Ye(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function yn(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=Ye(t.className,e):t.setAttribute("class",Ye(t.className&&t.className.baseVal||"",e))}const se={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class vn extends Le{adjustAndStore(e,n,s){const r=n.style[e];n.dataset[e]=r,Q(n,{[e]:`${parseFloat(Q(n,e))+s}px`})}restore(e,n){const s=n.dataset[e];s!==void 0&&(delete n.dataset[e],Q(n,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const n=this.getElement();if(xn(n,"modal-open"),!e.scrollBarWidth)return;const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";oe(n,se.FIXED_CONTENT).forEach(a=>this.adjustAndStore(s,a,e.scrollBarWidth)),oe(n,se.STICKY_CONTENT).forEach(a=>this.adjustAndStore(r,a,-e.scrollBarWidth)),oe(n,se.NAVBAR_TOGGLER).forEach(a=>this.adjustAndStore(r,a,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const n=this.getElement();yn(n,"modal-open");const s=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";oe(n,se.FIXED_CONTENT).forEach(a=>this.restore(s,a)),oe(n,se.STICKY_CONTENT).forEach(a=>this.restore(r,a)),oe(n,se.NAVBAR_TOGGLER).forEach(a=>this.restore(r,a))}}let Se;function bn(t){return Se||(Se=new vn(t)),Se}const ft=i.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=D(e,"modal-body"),o.jsx(n,{ref:r,className:F(t,e),...s})));ft.displayName="ModalBody";const ht=i.createContext({onHide(){}}),De=i.forwardRef(({bsPrefix:t,className:e,contentClassName:n,centered:s,size:r,fullscreen:a,children:c,scrollable:f,...h},x)=>{t=D(t,"modal");const p=`${t}-dialog`,E=typeof a=="string"?`${t}-fullscreen-${a}`:`${t}-fullscreen`;return o.jsx("div",{...h,ref:x,className:F(p,e,r&&`${t}-${r}`,s&&`${p}-centered`,f&&`${p}-scrollable`,a&&E),children:o.jsx("div",{className:F(`${t}-content`,n),children:c})})});De.displayName="ModalDialog";const pt=i.forwardRef(({className:t,bsPrefix:e,as:n="div",...s},r)=>(e=D(e,"modal-footer"),o.jsx(n,{ref:r,className:F(t,e),...s})));pt.displayName="ModalFooter";const wn=i.forwardRef(({closeLabel:t="Close",closeVariant:e,closeButton:n=!1,onHide:s,children:r,...a},c)=>{const f=i.useContext(ht),h=Y(()=>{f==null||f.onHide(),s==null||s()});return o.jsxs("div",{ref:c,...a,children:[r,n&&o.jsx($e,{"aria-label":t,variant:e,onClick:h})]})}),mt=i.forwardRef(({bsPrefix:t,className:e,closeLabel:n="Close",closeButton:s=!1,...r},a)=>(t=D(t,"modal-header"),o.jsx(wn,{ref:a,...r,className:F(e,t),closeLabel:n,closeButton:s})));mt.displayName="ModalHeader";const jn=It("h4"),gt=i.forwardRef(({className:t,bsPrefix:e,as:n=jn,...s},r)=>(e=D(e,"modal-title"),o.jsx(n,{ref:r,className:F(t,e),...s})));gt.displayName="ModalTitle";function En(t){return o.jsx(tt,{...t,timeout:null})}function Cn(t){return o.jsx(tt,{...t,timeout:null})}const xt=i.forwardRef(({bsPrefix:t,className:e,style:n,dialogClassName:s,contentClassName:r,children:a,dialogAs:c=De,"data-bs-theme":f,"aria-labelledby":h,"aria-describedby":x,"aria-label":p,show:E=!1,animation:_=!0,backdrop:y=!0,keyboard:v=!0,onEscapeKeyDown:N,onShow:l,onHide:u,container:k,autoFocus:M=!0,enforceFocus:O=!0,restoreFocus:B=!0,restoreFocusOptions:j,onEntered:m,onExit:R,onExiting:w,onEnter:S,onEntering:A,onExited:$,backdropClassName:T,manager:H,...J},I)=>{const[V,d]=i.useState({}),[g,P]=i.useState(!1),L=i.useRef(!1),q=i.useRef(!1),U=i.useRef(null),[z,X]=Pt(),_e=zt(I,X),fe=Y(u),Ne=Wt();t=D(t,"modal");const re=i.useMemo(()=>({onHide:fe}),[fe]);function Z(){return H||bn({isRTL:Ne})}function he(b){if(!Fe)return;const ne=Z().getScrollbarWidth()>0,Pe=b.scrollHeight>Ze(b).documentElement.clientHeight;d({paddingRight:ne&&!Pe?Ge():void 0,paddingLeft:!ne&&Pe?Ge():void 0})}const ee=Y(()=>{z&&he(z.dialog)});rt(()=>{He(window,"resize",ee),U.current==null||U.current()});const ae=()=>{L.current=!0},te=b=>{L.current&&z&&b.target===z.dialog&&(q.current=!0),L.current=!1},C=()=>{P(!0),U.current=Vt(z.dialog,()=>{P(!1)})},pe=b=>{b.target===b.currentTarget&&C()},ie=b=>{if(y==="static"){pe(b);return}if(q.current||b.target!==b.currentTarget){q.current=!1;return}u==null||u()},wt=b=>{v?N==null||N(b):(b.preventDefault(),y==="static"&&C())},jt=(b,ne)=>{b&&he(b),S==null||S(b,ne)},Et=b=>{U.current==null||U.current(),R==null||R(b)},Ct=(b,ne)=>{A==null||A(b,ne),Ht(window,"resize",ee)},_t=b=>{b&&(b.style.display=""),$==null||$(b),He(window,"resize",ee)},Nt=i.useCallback(b=>o.jsx("div",{...b,className:F(`${t}-backdrop`,T,!_&&"show")}),[_,T,t]),Ie={...n,...V};Ie.display="block";const kt=b=>o.jsx("div",{role:"dialog",...b,style:Ie,className:F(e,t,g&&`${t}-static`,!_&&"show"),onClick:y?ie:void 0,onMouseUp:te,"data-bs-theme":f,"aria-label":p,"aria-labelledby":h,"aria-describedby":x,children:o.jsx(c,{...J,onMouseDown:ae,className:s,contentClassName:r,children:a})});return o.jsx(ht.Provider,{value:re,children:o.jsx(gn,{show:E,ref:_e,backdrop:y,container:k,keyboard:!0,autoFocus:M,enforceFocus:O,restoreFocus:B,restoreFocusOptions:j,onEscapeKeyDown:wt,onShow:l,onHide:u,onEnter:jt,onEntering:Ct,onEntered:m,onExit:Et,onExiting:w,onExited:_t,manager:Z(),transition:_?En:void 0,backdropTransition:_?Cn:void 0,renderBackdrop:Nt,renderDialog:kt})})});xt.displayName="Modal";const ce=Object.assign(xt,{Body:ft,Header:mt,Title:gt,Footer:pt,Dialog:De,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),_n={"category-selector":"_category-selector_1aq5o_1"},Nn={nc:"Norm-conserving",us:"Ultrasoft",paw:"PAW"},kn=({categories:t,activeCategories:e,onCategorySelect:n})=>o.jsx("div",{className:_n["category-selector"],children:t.map(s=>o.jsx(Jt.Check,{type:"checkbox",id:`category-${s}`,label:Nn[s]||s,checked:e.includes(s),onChange:r=>r.target.checked?n([...e,s]):n(e.filter(a=>a!==s))},s))}),Te={"convergence-summary-header":"_convergence-summary-header_1ed6f_1","convergence-plot-container":"_convergence-plot-container_1ed6f_1","convergence-plot-details-container":"_convergence-plot-details-container_1ed6f_1"},On={"convergence-plot":"_convergence-plot_b9eda_1"};var yt={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Qe=G.createContext&&G.createContext(yt),Rn=["attr","size","title"];function Sn(t,e){if(t==null)return{};var n=Tn(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Tn(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function je(){return je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},je.apply(this,arguments)}function Je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Je(Object(n),!0).forEach(function(s){An(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function An(t,e,n){return e=Mn(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mn(t){var e=Fn(t,"string");return typeof e=="symbol"?e:e+""}function Fn(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vt(t){return t&&t.map((e,n)=>G.createElement(e.tag,Ee({key:n},e.attr),vt(e.child)))}function Bn(t){return e=>G.createElement(Un,je({attr:Ee({},t.attr)},e),vt(t.child))}function Un(t){var e=n=>{var{attr:s,size:r,title:a}=t,c=Sn(t,Rn),f=r||n.size||"1em",h;return n.className&&(h=n.className),t.className&&(h=(h?h+" ":"")+t.className),G.createElement("svg",je({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,c,{className:h,style:Ee(Ee({color:t.color||n.color},n.style),t.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),a&&G.createElement("title",null,a),t.children)};return Qe!==void 0?G.createElement(Qe.Consumer,null,n=>e(n)):e(yt)}function $n(t){return Bn({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"},child:[]},{tag:"path",attr:{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"},child:[]}]})(t)}const Ln="_modalBody_f8cvt_1",Dn="_content_f8cvt_5",In="_pre_f8cvt_12",Pn="_loadContainer_f8cvt_20",zn="_hint_f8cvt_30",Wn="_message_f8cvt_34",Hn="_filename_f8cvt_1",Vn="_downloadUpfText_f8cvt_1",qn="_downloadUpfButton_f8cvt_1",W={modalBody:Ln,content:Dn,pre:In,loadContainer:Pn,hint:zn,message:Wn,filename:Hn,downloadUpfText:Vn,downloadUpfButton:qn},Kn=({show:t,element:e,pseudoName:n,Z:s,onHide:r})=>{const{getUpfUuid:a,getPseudoFilename:c}=i.useContext(nt),[f,h]=i.useState(""),[x,p]=i.useState(""),[E,_]=i.useState(!1),[y,v]=i.useState(!1),[N,l]=i.useState(null),u=!!qt,k=i.useMemo(()=>!e||!n||s===void 0?"":a(e,n,s),[e,n,s,a]),M=i.useMemo(()=>!e||!n||s===void 0?"":c(e,n,s),[e,n,s,c]);i.useEffect(()=>{t&&(l(null),h(""),_(!1),v(!1),p(M||""))},[t,e,n,s,M]);const O=async()=>{if(l(null),!u){l("UPF viewer is unavailable (VITE_API_URL is not set)");return}if(!n||s===void 0){l("No pseudopotential selected");return}if(!k){l("No UPF UUID found for this pseudopotential");return}_(!0);try{const{filename:m,content:R}=await qe.fetchUpfFile(k);p(w=>w||m),h(R)}catch(m){m instanceof Error&&l(m.message||"Failed to load UPF file")}finally{_(!1)}},B=async()=>{if(l(null),!u){l("UPF download is unavailable (VITE_API_URL is not set)");return}if(!k){l("No UPF UUID found for this pseudopotential");return}v(!0);try{const{filename:m,blob:R}=await qe.fetchUpfBlob(k),w=URL.createObjectURL(R),S=document.createElement("a");S.href=w;const A=`${e}-${n||"pseudo"}${s!==void 0?`-Z${s}`:""}.upf`;S.download=x||m||A,document.body.appendChild(S),S.click(),S.remove(),URL.revokeObjectURL(w)}catch(m){m instanceof Error&&l((m==null?void 0:m.message)||"Failed to download UPF file")}finally{v(!1)}},j=!u||!k;return o.jsxs(ce,{show:t,onHide:r,size:"xl",centered:!0,scrollable:!0,children:[o.jsx(ce.Header,{closeButton:!0,children:o.jsxs(ce.Title,{children:[e," (Z",o.jsx("sub",{children:"val"})," = ",s,") ",n]})}),o.jsx(ce.Body,{className:W.modalBody,children:N?o.jsx("div",{className:W.message,children:N}):E?o.jsx(ot,{}):f?o.jsx("div",{className:W.content,children:o.jsx("pre",{className:W.pre,children:f})}):u?k?o.jsxs("div",{className:W.loadContainer,children:[o.jsx(Ve,{variant:"primary",onClick:O,children:"Load UPF content"}),o.jsx("div",{className:W.hint,children:"May take some time"})]}):o.jsx("div",{className:W.message,children:"No UPF UUID found for this pseudopotential."}):o.jsx("div",{className:W.message,children:"Backend not configured. UPF download/viewing is unavailable."})}),o.jsxs(ce.Footer,{className:"justify-content-start",children:[o.jsxs(Ve,{id:W.downloadUpfButton,variant:"primary",onClick:B,disabled:j||y,children:[o.jsx("span",{id:W.downloadUpfText,children:"Download UPF file"}),y?o.jsx("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:o.jsx("span",{className:"visually-hidden",children:"Loading..."})}):o.jsx($n,{})]}),o.jsx("span",{id:W.filename,children:x})]})]})},Ae=1.2,Me=1.3,xe=.13,bt=6,de=1,K=10,Gn=40,Xn=80,ye=2,ve=8,Yn=120,Qn=new Set(["O","Fe","Mn","Hf","Co","Ni","Cr"]),Jn=.2,Zn=2,eo=1,to=["δω","δV<sub>press</sub>","δE<sub>coh</sub>","δν"],no=["circle","triangle-down","star","square"],oo=["solid","dash","dot","solid"],be={phononFrequencies:{label:"δω",symbol:"circle",dash:"solid"},pressure:{label:"δV<sub>press</sub>",symbol:"triangle-down",dash:"dash"},cohesiveEnergy:{label:"δE<sub>coh</sub>",symbol:"star",dash:"dot"},eos:{label:"δν",symbol:"square",dash:"solid"}},so=(t,e,n,s,r)=>{const a=ve/4,c=s.map((y,v)=>v*ve),f=s.length*Yn+(Gn+Xn),h=Qn.has(t)?18:8,x=[],p=[],E=[];s.forEach((y,v)=>{var I,V;const N=((I=r[y.name])==null?void 0:I.color)||"black",l=v*ve,{quantities:u}=y;let k=[],M=[],O=[],B=[],j=[],m=[],R=[],w;if(u.phononFrequencies){k=u.phononFrequencies.values.map(g=>g*2/Zn),w=we(be.phononFrequencies,N),w.x=u.phononFrequencies.cutoffs,w.y=k.map(g=>g+l),M=u.phononFrequencies.error,w.error_y={type:"data",array:M,arrayminus:k.map(()=>0),visible:!0,color:N},x.push(w);const d=u.phononFrequencies.ref.toFixed(2);p.push({x:203.1,y:l-1,text:`ω<sub>max</sub> = ${d} cm<sup>-1</sup>`,showarrow:!1,font:{size:K}})}if(u.pressure&&(w=we(be.pressure,N),O=u.pressure.values.map(d=>d*2/eo),w.x=u.pressure.cutoffs,w.y=O.map(d=>d+l),x.push(w)),u.cohesiveEnergy){w=we(be.cohesiveEnergy,N),B=u.cohesiveEnergy.values,w.x=u.cohesiveEnergy.cutoffs,w.y=B.map(g=>g+l),x.push(w);const d=u.cohesiveEnergy.ref.toFixed(2);p.push({x:205,y:l+1,text:`E<sub>coh</sub> = ${d} <i>meV/atom</i>`,showarrow:!1,font:{size:K}})}if(u.eos&&(w=we(be.eos,N),j=u.eos.values.map(d=>d*2/Jn),w.x=u.eos.cutoffs,w.y=j.map(d=>d+l),x.push(w)),u.bands){const d=u.bands.cutoffs;m=u.bands.eta_c,R=u.bands.max_diff_c,p.push({x:24,y:l+Ae*a+xe,text:"       <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:K}}),x.push({x:d,y:m.map(()=>l+Ae*a),type:"scatter",mode:"text",text:m.map(g=>g>=100?g.toExponential(0).toString().replace("e+","e"):g.toFixed(2)),showlegend:!1,textfont:{size:K},hoverinfo:"skip"}),p.push({x:205,y:l+Ae*a+xe,text:"[meV]",showarrow:!1,align:"left",font:{size:K}}),x.push({x:[0,250],y:[l+a,l+a],type:"scatter",mode:"lines",text:m.map(g=>g.toFixed(2)),showlegend:!1,line:{color:N,width:de,dash:"dashdot"},hoverinfo:"skip"}),x.push({x:[0,250],y:[l+a/2,l+a/2],type:"scatter",mode:"lines",text:m.map(g=>g.toFixed(2)),showlegend:!1,line:{color:"lightgray",width:de,dash:"dot"},hoverinfo:"skip"}),p.push({x:24,y:l-Me*a+xe,text:"max <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:K}}),x.push({x:d,y:R.map(()=>l-Me*a),type:"scatter",mode:"text",text:R.map(g=>g>=100?g.toExponential(0).toString().replace("e+","e"):g.toFixed(2)),showlegend:!1,textfont:{size:K},hoverinfo:"skip"}),p.push({x:205,y:l-Me*a+xe,text:"[meV]",showarrow:!1,align:"left",font:{size:K}}),x.push({x:[0,250],y:[l-a,l-a],type:"scatter",mode:"lines",text:R.map(g=>g.toFixed(2)),showlegend:!1,line:{color:N,width:de,dash:"dashdot"},hoverinfo:"skip"})}E.push({type:"line",x0:18,x1:216,y0:l,y1:l,opacity:.25,line:{width:.5}});const S=((V=y.quantities.bands)==null?void 0:V.cutoffs)||[],A=[S],$=["E<sub>wfc</sub> = %{customdata[0]} Ry"];let T=1;if(k.length){A.push(k);let d=`<br />δω = %{customdata[${T}]:.3f}`;T+=1,M.length&&(A.push(M),d+=` &plusmn; %{customdata[${T}]:.1e}`,T+=1),d+="%",$.push(d)}O.length&&(A.push(O),$.push(`<br />δV<sub>press</sub> = %{customdata[${T}]:.3f}%`),T+=1),B.length&&(A.push(B),$.push(`<br />δE<sub>coh</sub> = %{customdata[${T}]:.3f} meV`),T+=1),j.length&&(A.push(j),$.push(`<br />δv = %{customdata[${T}]:.3f}`),T+=1),m.length&&(A.push(m),$.push(`<br />η<sub>10</sub> = %{customdata[${T}]:.3f} meV`),T+=1),R.length&&(A.push(R),$.push(`<br />max η<sub>10</sub> = %{customdata[${T}]:.3f} meV`),T+=1),x.push({x:S,y:new Array(S.length).fill(l),mode:"markers",marker:{size:24,opacity:0,line:{width:0}},showlegend:!1,customdata:S.map((d,g)=>A.map(P=>P[g])),hoverlabel:{bgcolor:"rgb(225, 225, 225)",bordercolor:"black"},hovertemplate:`<b>${y.name}</b><br />`+$.join("")+"<extra></extra>"});const{metadata:H}=y.quantities;let J="not all EOS valid";if(H){const d=H.avg_nu.toFixed(2),g=H.max_nu.toFixed(2),P=on(H.max_conf),L=H.avg_nu_wo_max.toFixed(2);J=`ν<sub>avg</sub> = ${d}<br />ν<sub>max</sub> = ${g} (${P})<br />ν<sub>avg</sub> (w/o max) = ${L}`}p.push({xref:"paper",x:-.1,y:l,text:`<span style="color:#0d6efd"><b>${y.name}</b></span><br />Z<sub>val</sub> = ${y.Z}<br />${J}`,showarrow:!1,align:"left",font:{size:10},captureevents:!0}),e.forEach(d=>{if(n[d].pseudopotential===y.name&&n[d].Z===y.Z){const g=n[d].cutoff_wfc;if(d==="efficiency")E.push({type:"rect",x0:g-ye,x1:g+ye,y0:c[v]-a,y1:c[v]+a,fillcolor:"lightgreen",line:{width:1,color:"green"},opacity:.5});else{const P=g-ye,L=g+ye,q=c[v]-a,U=c[v]+a,z=(P+L)/2,X=(q+U)/2;E.push({type:"path",path:`M ${z} ${U} L ${L} ${X} L ${z} ${q} L ${P} ${X} Z`,fillcolor:"lightcoral",line:{width:1,color:"darkred"},opacity:.5})}}})}),to.forEach((y,v)=>{x.push({name:y,type:"scatter",mode:"lines+markers",x:[NaN],y:[NaN],line:{color:"black",width:de,dash:oo[v]},marker:{size:bt,symbol:no[v]},showlegend:!0,legendgroup:y,hoverinfo:"skip"})});const _={xaxis:{title:{text:`Wavefunction cutoff [Ry]; Charge density cutoff [Ry] = ${h} x Ewfc (PAW/US) | 4 x Ewfc (NC); q-point = [0.5, 0.5, 0.5]`},showgrid:!1,showline:!0,mirror:!0,tickvals:[...Array.from({length:18},(y,v)=>v*10+30)],ticks:"inside",ticklen:5,range:[18,216],fixedrange:!0},yaxis:{side:"right",title:{text:"Error w.r.t. ref. wavefunction cutoff"},zeroline:!1,showgrid:!1,showline:!0,mirror:!0,ticks:"inside",ticklen:5,tickmode:"array",tickvals:c,ticktext:c.map(()=>"0"),range:[-5,(s.length-1)*ve+5],fixedrange:!0},showlegend:!0,legend:{x:1.05,y:1,xanchor:"left",yanchor:"top",font:{size:K,color:"black"},bordercolor:"lightgrey",borderwidth:1},annotations:p,shapes:E,hovermode:"closest",height:f,margin:{l:160,r:80,t:10,b:70}};return{data:x,layout:_}},we=(t,e)=>({name:t.label,type:"scatter",mode:"lines+markers",line:{color:e,width:de,dash:t.dash},marker:{size:bt,symbol:t.symbol},showlegend:!1,legendgroup:t.label,hoverinfo:"skip"}),ro={responsive:!0,displayModeBar:!1,displaylogo:!1},ao=({element:t,summaryData:e,pseudosMetadata:n})=>{const{libraries:s}=i.useContext(Kt),{elementsInfo:r}=i.useContext(st),[a,c]=i.useState(!1),[f,h]=i.useState(""),[x,p]=i.useState(),E=i.useRef(null),_=i.useMemo(()=>!e||!e.pseudos?[]:e.pseudos.filter(v=>n==null?void 0:n[v.name]).reverse(),[e,n]),y=i.useMemo(()=>Object.fromEntries(Object.entries(r).map(([v,N])=>[v,N[t]])),[r,t]);return i.useEffect(()=>{if(!_.length||!E.current)return;let v=!1,N=null,l=null;return(async()=>{var M;if(N=(await Gt(async()=>{const{default:O}=await import("./PlotlyLoader-D3vtWR5M.js");return{default:O}},__vite__mapDeps([0,1,2,3]))).default,v||!E.current)return;const{data:u,layout:k}=so(t,s,y,_,n);l=await N.react(E.current,u,k,ro),(M=l.removeAllListeners)==null||M.call(l,"plotly_clickannotation"),l.on("plotly_clickannotation",async O=>{var A;const B=O&&typeof O=="object"&&"annotation"in O?(A=O.annotation)==null?void 0:A.text:void 0,j=typeof B=="string"?B:"",m=j.match(/<b>(.*?)<\/b>/),R=m==null?void 0:m[1];if(!R)return;const w=j.match(/Z<sub>val<\/sub>\s*=\s*(\d+)/),S=w?Number.parseInt(w[1],10):NaN;Number.isFinite(S)&&(h(R),p(S),c(!0))})})(),()=>{var u;v=!0,l&&((u=l.removeAllListeners)==null||u.call(l,"plotly_clickannotation"))}},[t,e,s,y,_,n]),_.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:E,id:On["convergence-plot"]}),o.jsx(Kn,{show:a,element:t,pseudoName:f,Z:x,onHide:()=>c(!1)})]}):o.jsx(Zt,{})},io={"convergence-plot-legend-table":"_convergence-plot-legend-table_1h1ks_1"},lo=()=>o.jsx(me,{children:o.jsxs(me.Item,{eventKey:"0",children:[o.jsx(me.Header,{children:"About the SSSP protocol convergence pattern plots"}),o.jsxs(me.Body,{children:[o.jsxs("section",{children:[o.jsx("p",{children:"We report here the zone-boundary phonons, cohesive energy, pressure, and band structure versus the wavefunction cutoff for all the considered pseudopotential libraries."}),o.jsxs("p",{children:["The colored horizontal dashed lines correspond to the thresholds of the SSSP efficiency criteria, whereas the gray dotted lines correspond to the precision criteria. ",o.jsx("br",{})," The recommended efficiency (precision) pseudopotential is marked with a"," ",o.jsx("span",{style:{color:"green"},children:"rectangle"})," (",o.jsx("span",{style:{color:"red"},children:"diamond"}),") at the recommended cutoff."]})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Metadata"}),"We report on the left of the plot:",o.jsxs("ul",{children:[o.jsx("li",{children:"the number of valence electrons of the pseudopotential"}),o.jsxs("li",{children:["the average of ",o.jsx("b",{children:"ν"}),", a *metric relating to the equation of state, across 10 structures"]}),o.jsxs("li",{children:["the maximum ",o.jsx("b",{children:"ν"})," value"]}),o.jsxs("li",{children:["the average of ",o.jsx("b",{children:"ν"}),", excluding the XO",o.jsx("sub",{children:"3"})," structure"]})]}),o.jsx("p",{children:"Tip: click a pseudopotential label on the left to open its UPF viewer (available when an API backend is configured)."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Legend"}),o.jsxs("p",{children:["Each pseudopotential is represented in its own color. The legend items are kept in black and reflect the corresponding quantity/discrepancy across all pseudopotentials.",o.jsx("br",{}),"The markers correspond to the following quantities:"]}),o.jsxs(Xt,{id:io["convergence-plot-legend-table"],striped:!0,bordered:!0,responsive:!0,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Marker"}),o.jsx("th",{children:"Quantity"}),o.jsx("th",{children:"Units"}),o.jsx("th",{children:"Description"})]})}),o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("td",{children:"●"}),o.jsx("td",{children:"δω"}),o.jsx("td",{children:"%"}),o.jsx("td",{children:"Discrepancy in all phonon frequencies at the zone boundary"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"▼"}),o.jsxs("td",{children:["δV",o.jsx("sub",{children:"press"})]}),o.jsx("td",{children:"%"}),o.jsx("td",{children:"Discrepancy in pressure"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"★"}),o.jsxs("td",{children:["δE",o.jsx("sub",{children:"coh"})]}),o.jsx("td",{children:"meV"}),o.jsx("td",{children:"Discrepancy in cohesive energy"})]}),o.jsxs("tr",{children:[o.jsx("td",{children:"■"}),o.jsx("td",{children:"δν"}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"Discrepancy in equation of state"})]})]})]}),o.jsx("p",{children:"A single click on a legend item toggles its visibility, while a double click isolates it."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Categories"}),o.jsx("p",{children:"You can use the pseudopotential category checkboxes to filter the pseudopotentials shown in the plots."})]}),o.jsxs("section",{children:[o.jsx("h5",{children:"Additional information"}),o.jsxs("p",{children:["See the ",o.jsx("b",{children:"About"})," tab of the"," ",o.jsx("a",{href:"https://acwf-verification.materialscloud.org/",target:"_blank",style:{textDecoration:"none"},children:"Verification of the precision of DFT implementations via AiiDA common workflows"})," ","app to learn more about how ",o.jsx("b",{children:"ν"})," is computed. ",o.jsx("br",{}),"All calculations are performed on the ground-state elemental solids unless stated otherwise (i.e. rare-earths and flourine). See"," ",o.jsx(Yt,{to:"/about",style:{textDecoration:"none"},children:"About SSSP"})," ","for more details."]})]})]})]})}),ho=()=>{const{element:t}=i.useContext(st),{loadingMetadata:e,categories:n,pseudosMetadata:s,activeCategories:r,setActiveCategories:a}=i.useContext(nt),{loadingConvergenceData:c,convergenceData:f}=i.useContext(Qt),h=i.useMemo(()=>{const p={};return Object.entries(s).forEach(([E,_])=>{r.includes(_.category)&&(p[E]=_)}),p},[r,s]);return e||c?o.jsx(ot,{}):o.jsxs("div",{id:"convergence-summary",children:[o.jsxs("div",{id:Te["convergence-summary-header"],children:[o.jsxs("h2",{className:"display-6",children:["Verification summary: ",t," (",f.conff,")"]}),o.jsx(kn,{categories:n,activeCategories:r,onCategorySelect:a})]}),o.jsx("div",{id:Te["convergence-plot-container"],children:o.jsx(ao,{element:t,summaryData:f,pseudosMetadata:h})}),o.jsx("div",{id:Te["convergence-plot-details-container"],children:o.jsx(lo,{})})]})};export{ho as default};
