import{r as y,S as M,P as j,j as h,L as U,a as W}from"./index-BorDEQ2H.js";const Z={"convergence-plot":"_convergence-plot_180qg_1"},B=new Set(["O","Fe","Mn","Hf","Co","Ni","Cr"]),P=8,n=P/4,$=1.2,C=1.3,k=.005,E=6,v=1,l=10,G={responsive:!0,displayModeBar:!1,displaylogo:!1},I=({element:d,library:c})=>{const[z,A]=y.useState(!0),[q,F]=y.useState(""),[m,R]=y.useState([]),w=y.useRef(null);return y.useEffect(()=>{new M().fetchPseudosSummaryData(c,d).then(p=>{F(p.conff),R(p.pseudos.slice(0,20))}).catch(p=>{console.error("Error fetching data:",p),F(""),R([])}).finally(()=>{A(!1)})},[d,c]),y.useEffect(()=>{if(z||!m.length||!w.current)return;const O=c==="efficiency"?.2:.1,p=c==="efficiency"?2:1,L=c==="efficiency"?1:.5,i=[],f=[],H=m.length*100+600,_=m.map((t,b)=>b*P),N=B.has(d)?18:8;let x=!1;m.forEach((t,b)=>{const o=b*P,S=t.color=="#000000",{quantities:e}=t;if(e.phonon_frequencies){const r=e.phonon_frequencies.values.map(a=>a*2/p),s=e.phonon_frequencies.error;i.push({name:"δω",type:"scatter",mode:"lines+markers",line:{color:t.color,width:v,dash:"solid"},marker:{size:E,symbol:"circle"},showlegend:!x&&S,x:e.phonon_frequencies.cutoffs,y:r.map(a=>a+o),error_y:{type:"data",array:s,arrayminus:r.map(()=>0),visible:!0,color:t.color},customdata:r.map((a,D)=>[a,s[D]]),hovertemplate:`<b>${t.name}<br>δω: %{customdata[0]:.1e} &plusmn; %{customdata[1]:.1e} cm<sup>-1</sup></b><extra></extra>`});const u=e.phonon_frequencies.ref.toFixed(2);f.push({x:203.1,y:o-1,text:`ω<sub>max</sub> = ${u} cm<sup>-1</sup>`,showarrow:!1,font:{size:l}})}if(e.pressure){const r=e.pressure.values.map(s=>s*2/L);i.push({name:"δV<sub>press</sub>",type:"scatter",mode:"lines+markers",line:{color:t.color,width:v,dash:"dash"},marker:{size:E,symbol:"triangle-down"},showlegend:!x&&S,x:e.pressure.cutoffs,y:r.map(s=>s+o),customdata:r,hovertemplate:`<b>${t.name}<br>δV<sub>press</sub>: %{customdata:.2f}</b><extra></extra>`})}if(e.cohesive_energy){const r=e.cohesive_energy.values;i.push({name:"δE<sub>coh</sub>",type:"scatter",mode:"lines+markers",line:{color:t.color,width:v,dash:"dot"},marker:{size:E,symbol:"star"},showlegend:!x&&S,x:e.cohesive_energy.cutoffs,y:r.map(u=>u+o),customdata:r,hovertemplate:`<b>${t.name}<br>δE<sub>coh</sub>: %{customdata:.2f}</b><extra></extra>`});const s=e.cohesive_energy.ref.toFixed(2);f.push({x:205,y:o+1,text:`E<sub>coh</sub> = ${s} <i>meV/atom</i>`,showarrow:!1,font:{size:l}})}if(e.eos){const r=e.eos.values.map(s=>s*2/O);i.push({name:"δv",type:"scatter",mode:"lines+markers",line:{color:t.color,width:v,dash:"dot"},marker:{size:E,symbol:"square"},showlegend:!x&&S,x:e.eos.cutoffs,y:r.map(s=>s+o),customdata:r,hovertemplate:`<b>${t.name}<br>δv: %{customdata:.2f}</b><extra></extra>`})}if(e.bands){const r=e.bands.cutoffs,s=e.bands.eta_c,u=e.bands.max_diff_c;f.push({x:24,y:o+$*n+k,text:"       <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:l}}),i.push({x:r,y:s.map(()=>o+$*n),type:"scatter",mode:"text",text:s.map(a=>a.toFixed(2)),showlegend:!1,textfont:{size:l},hoverinfo:"skip"}),f.push({x:205,y:o+$*n+k,text:"[meV]",showarrow:!1,align:"left",font:{size:l}}),i.push({x:[0,250],y:[o+n,o+n],type:"scatter",mode:"lines",text:s.map(a=>a.toFixed(2)),showlegend:!1,line:{color:t.color,width:v,dash:"dashdot"},hoverinfo:"skip"}),f.push({x:24,y:o-C*n+k,text:"max <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:l}}),i.push({x:r,y:u.map(()=>o-C*n),type:"scatter",mode:"text",text:u.map(a=>a.toFixed(2)),showlegend:!1,textfont:{size:l},hoverinfo:"skip"}),f.push({x:205,y:o-C*n+k,text:"[meV]",showarrow:!1,align:"left",font:{size:l}}),i.push({x:[0,250],y:[o-n,o-n],type:"scatter",mode:"lines",text:u.map(a=>a.toFixed(2)),showlegend:!1,line:{color:t.color,width:v,dash:"dashdot"},hoverinfo:"skip"}),x=x||S}const{metadata:g}=t.quantities,V=g?`avg.v = ${g.avg_nu.toFixed(2)}<br>max.v = ${g.max_nu.toFixed(2)} (${g.max_conf})<br>ang.v = ${g.ang_nu.toFixed(2)} (w/o XO3)`:"not all EOS valid";f.push({xref:"paper",x:g?1.1:1.085,y:o,text:`${t.name}<br>Z = ${t.Z}<br>${V}`,showarrow:!1,align:"center",font:{size:10}})});const T={title:{text:`Verification summary: ${d} (${q}) (${c})`},xaxis:{title:{text:`Wavefunction cutoff [Ry]; Charge density cutoff [Ry] = ${N} x Ewfc (PAW/US) | 4 x Ewfc (NC); q-point = [0.5, 0.5, 0.5]`},showgrid:!1,showline:!0,mirror:!0,tickvals:[...Array.from({length:18},(t,b)=>b*10+30)],ticks:"inside",ticklen:5,range:[18,216],fixedrange:!0},yaxis:{title:{text:`Error w.r.t. ref. wavefunction cutoff (for the SSSP ${c} criteria)`},zeroline:!1,showgrid:!1,showline:!0,mirror:!0,ticks:"inside",ticklen:5,tickmode:"array",tickvals:_,ticktext:_.map(()=>"0"),range:[-5,_[_.length-1]+5],fixedrange:!0},showlegend:!0,legend:{x:-.07,y:1,xanchor:"left",yanchor:"top",font:{size:l,color:"black"},bordercolor:"lightgrey",borderwidth:1},annotations:f,hovermode:"closest",height:H,margin:{l:100,r:160,t:40,b:80}};return j.react(w.current,i,T,G),()=>{w.current&&j.purge(w.current)}},[z,m]),z?h.jsx(U,{}):!q||!m.length?h.jsx("span",{children:"No data available"}):h.jsx("div",{ref:w,id:Z["convergence-plot"]})},J=({element:d,activeLibrary:c})=>h.jsxs("div",{id:"convergence-plots",children:[h.jsx(I,{element:d,library:c}),h.jsx("hr",{}),h.jsxs("div",{id:"convergence-plot-note",children:["Convergence pattern plots according to the SSSP protocol: zone-boundary phonons, cohesive energy, pressure and band structure versus the wavefunction cutoff for all the considered pseudopotential libraries (the horizontal dashed lines correspond to the thresholds of the SSSP selection criteria). On the right-hand side we report the number of valence electrons of the pseudopotential, the delta-factor with respect to the reference all-electron results and the maximum phonon frequency. All calculations are performed on the ground-state elemental solids unless stated otherwise (i.e. rare-earths and flourine). The circle marks the pseudopotential and wavefunction cutoff chosen for the SSSP library (see ",h.jsx(W,{to:"/about",children:"About SSSP"})," for more details)."]})]});export{J as default};
