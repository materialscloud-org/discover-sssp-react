const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-DgOoZCHk.js","assets/index-BH0wW1rV.js","assets/index-Cjp2Xj_Y.css"])))=>i.map(i=>d[i]);
import{r as c,u as N,j as e,a as w,a2 as L,Q as b,U as x,_ as z,D as F,O as P,S as R,L as V}from"./index-BH0wW1rV.js";import{F as p,N as $}from"./NoDataMessage-D8qgxloP.js";const C=c.forwardRef(({bsPrefix:n,fluid:t=!1,as:o="div",className:r,...a},s)=>{const l=N(n,"container"),d=typeof t=="string"?`-${t}`:"-fluid";return e.jsx(o,{ref:s,...a,className:w(r,t?`${l}${d}`:l)})});C.displayName="Container";const v=({id:n,which:t,pseudos:o,value:r,onSelect:a})=>e.jsxs(p.Group,{id:n,children:[e.jsxs(p.Label,{htmlFor:`${t}-select`,children:[L(t),":"]}),e.jsx(p.Select,{id:`${t}-select`,value:r,onChange:s=>a(s.target.value),children:o.map(s=>e.jsx("option",{value:s,children:s},s))})]}),m={"band-structure-controls":"_band-structure-controls_1qzx4_1","compared-pseudo-selector":"_compared-pseudo-selector_1qzx4_1","reference-pseudo-selector":"_reference-pseudo-selector_1qzx4_1","pseudo-shift-range":"_pseudo-shift-range_1qzx4_1"},q=({pseudos:n,activePseudos:t,onPseudoSelect:o,bandShift:r,onBandShiftChange:a})=>e.jsxs("div",{id:m["band-structure-controls"],children:[e.jsxs(b,{className:"gap-3",children:[e.jsx(x,{sm:"6",lg:"12",children:e.jsx(v,{id:m["reference-pseudo-selector"],which:"reference",pseudos:n,value:t[0],onSelect:s=>{o([s,t[1]]),a(0)}})}),e.jsx(x,{children:e.jsx(v,{id:m["compared-pseudo-selector"],which:"compared",pseudos:n,value:t[1],onSelect:s=>{o([t[0],s]),a(0)}})})]}),e.jsxs(p.Group,{children:[e.jsx(p.Label,{htmlFor:m["pseudo-shift-range"],children:"Compared bands shift (meV):"}),e.jsxs(b,{style:{alignItems:"center"},children:[e.jsx(x,{xs:"8",sm:"9",md:"10",lg:"6",xl:"7",xxl:"8",children:e.jsx(p.Range,{id:m["pseudo-shift-range"],name:"pseudo-shift-range",value:r,min:-5e3,max:5e3,step:1,onChange:s=>a(Number(s.target.value))})}),e.jsx(x,{children:e.jsx(p.Control,{name:"pseudo-shift-number",type:"number",value:r.toFixed(0),min:-5e3,max:5e3,step:1,onChange:s=>a(Number(s.target.value))})})]})]})]}),O={"bands-note":"_bands-note_m1aly_1"},S={"bands-plot-wrapper":"_bands-plot-wrapper_1hzls_1","bands-plot":"_bands-plot_1hzls_1"},k=({pseudosMetadata:n,bandsPseudosMap:t,activePseudos:o,bandShift:r})=>{const a=c.useRef(null);return c.useEffect(()=>{if(t&&a.current){const s=M(o,t,r,n);if(!s.length)return;let l=null;(async()=>(l=(await z(async()=>{const{BandsVisualiser:d}=await import("./main-DgOoZCHk.js");return{BandsVisualiser:d}},__vite__mapDeps([0,1,2]))).BandsVisualiser,l(a.current,{bandsDataArray:s,settings:{showlegend:!1,yaxis:{range:[-20,20]}}})))()}},[o,t,n,r]),e.jsx("div",{id:S["bands-plot-wrapper"],children:e.jsx("div",{ref:a,id:S["bands-plot"]})})},M=(n,t,o,r)=>n.flatMap((a,s)=>{var f;const l=t[a];if(!l)return[];let d=-l.fermiLevel||0;return s===1&&(d+=o/1e3),[{bandsData:A(l,d),traceFormat:{line:{color:s===0?"black":((f=r[a])==null?void 0:f.color)||"red"}}}]}),A=(n,t)=>({...n,paths:n.paths.map(o=>({...o,values:o.values.map(r=>r.map(a=>a+t))}))}),T=({element:n})=>{const{loadingMetadata:t,pseudosMetadata:o}=c.useContext(F),{chessboardPseudos:r,bandShift:a,setBandShift:s}=c.useContext(P),[l,d]=c.useState(!0),[f,g]=c.useState({}),[h,j]=c.useState([]),[y,_]=c.useState(r);c.useEffect(()=>{n&&(d(!0),g({}),j([]),R.fetchBandsData(n).then(i=>{g(i);const u=i&&Object.keys(i);j(u)}).catch(i=>{console.error("Error fetching bands data:",i),g({}),j([])}).finally(()=>{d(!1)}))},[n]),c.useEffect(()=>{const i=u=>u.length===2&&u.every(E=>h.includes(E));if(!h.length){_([]);return}_(u=>i(r)?r:i(u)?u:[h[0],h[0]])},[h,r,n]);const B=l||t,D=Object.keys(f||{}).length>0;return B?e.jsx(V,{}):D?e.jsxs(C,{id:"bands-plots",children:[e.jsxs(b,{children:[e.jsx(x,{lg:"3",children:e.jsx(q,{pseudos:h,activePseudos:y,bandShift:a,onPseudoSelect:_,onBandShiftChange:s})}),e.jsx(x,{lg:"auto",className:"ms-lg-5",children:e.jsx(k,{pseudosMetadata:o,bandsPseudosMap:f,activePseudos:y,bandShift:a})})]}),e.jsx("div",{id:O["bands-note"],children:"Electronic band structure along high-symmetry path. The reference energy (0 eV) corresponds to the Fermi level."})]}):e.jsx($,{})};export{T as default};
