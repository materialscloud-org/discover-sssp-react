const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-O4gGgQGB.js","assets/index-BKNX4dWr.js","assets/index-CESS_hL7.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{j as e,r as x,L as K,E as Y,S as ee,_ as te,a as G,P as se,b as oe}from"./index-BKNX4dWr.js";import{F as re,N as ne}from"./NoDataMessage-DmJ_KHIF.js";const ae={"category-selector":"_category-selector_1aq5o_1"},ie={nc:"Norm-conserving",us:"Ultrasoft",paw:"PAW"},ce=({categories:c,activeCategories:d,onCategorySelect:g})=>e.jsx("div",{className:ae["category-selector"],children:c.map(l=>e.jsx(re.Check,{type:"checkbox",id:`category-${l}`,label:ie[l]||l,checked:d.includes(l),onChange:p=>p.target.checked?g([...d,l]):g(d.filter(S=>S!==l))},l))}),le={"convergence-plot":"_convergence-plot_b9eda_1"},H=1.2,U=1.3,N=.13,Q=6,z=1,_=10,he=40,ue=80,Z=2,T=8,de=120,fe=new Set(["O","Fe","Mn","Hf","Co","Ni","Cr"]),pe=.2,me=2,xe=1,ge=["δω","δV<sub>press</sub>","δE<sub>coh</sub>","δv"],be=["circle","triangle-down","star","square"],ye=["solid","dash","dot","solid"],M={phononFrequencies:{label:"δω",symbol:"circle",dash:"solid"},pressure:{label:"δV<sub>press</sub>",symbol:"triangle-down",dash:"dash"},cohesiveEnergy:{label:"δE<sub>coh</sub>",symbol:"star",dash:"dot"},eos:{label:"δv",symbol:"square",dash:"solid"}};function ve(c,d,g,l,p,S){const s=T/4,b=p.map((i,m)=>m*T),E=p.length*de+(he+ue),v=fe.has(c)?18:8,f=[],r=[],j=[];p.forEach((i,m)=>{var W,X;const w=((W=S[i.name])==null?void 0:W.color)||"black",o=m*T,{quantities:a}=i;let F=[],D=[],O=[],A=[],q=[];if(a.phononFrequencies){F=a.phononFrequencies.values.map(u=>u*2/me);let t=L(M.phononFrequencies,w);t.x=a.phononFrequencies.cutoffs,t.y=F.map(u=>u+o),D=a.phononFrequencies.error,t.error_y={type:"data",array:D,arrayminus:F.map(()=>0),visible:!0,color:w},f.push(t);const n=a.phononFrequencies.ref.toFixed(2);r.push({x:203.1,y:o-1,text:`ω<sub>max</sub> = ${n} cm<sup>-1</sup>`,showarrow:!1,font:{size:_}})}if(a.pressure){let t=L(M.pressure,w);O=a.pressure.values.map(n=>n*2/xe),t.x=a.pressure.cutoffs,t.y=O.map(n=>n+o),f.push(t)}if(a.cohesiveEnergy){let t=L(M.cohesiveEnergy,w);A=a.cohesiveEnergy.values,t.x=a.cohesiveEnergy.cutoffs,t.y=A.map(u=>u+o),f.push(t);const n=a.cohesiveEnergy.ref.toFixed(2);r.push({x:205,y:o+1,text:`E<sub>coh</sub> = ${n} <i>meV/atom</i>`,showarrow:!1,font:{size:_}})}if(a.eos){let t=L(M.eos,w);q=a.eos.values.map(n=>n*2/pe),t.x=a.eos.cutoffs,t.y=q.map(n=>n+o),f.push(t)}if(a.bands){const t=a.bands.cutoffs,n=a.bands.eta_c,u=a.bands.max_diff_c;r.push({x:24,y:o+H*s+N,text:"       <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:_}}),f.push({x:t,y:n.map(()=>o+H*s),type:"scatter",mode:"text",text:n.map(h=>h.toFixed(2)),showlegend:!1,textfont:{size:_},hoverinfo:"skip"}),r.push({x:205,y:o+H*s+N,text:"[meV]",showarrow:!1,align:"left",font:{size:_}}),f.push({x:[0,250],y:[o+s,o+s],type:"scatter",mode:"lines",text:n.map(h=>h.toFixed(2)),showlegend:!1,line:{color:w,width:z,dash:"dashdot"},hoverinfo:"skip"}),f.push({x:[0,250],y:[o+s/2,o+s/2],type:"scatter",mode:"lines",text:n.map(h=>h.toFixed(2)),showlegend:!1,line:{color:"lightgray",width:z,dash:"dot"},hoverinfo:"skip"}),r.push({x:24,y:o-U*s+N,text:"max <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:_}}),f.push({x:t,y:u.map(()=>o-U*s),type:"scatter",mode:"text",text:u.map(h=>h.toFixed(2)),showlegend:!1,textfont:{size:_},hoverinfo:"skip"}),r.push({x:205,y:o-U*s+N,text:"[meV]",showarrow:!1,align:"left",font:{size:_}}),f.push({x:[0,250],y:[o-s,o-s],type:"scatter",mode:"lines",text:u.map(h=>h.toFixed(2)),showlegend:!1,line:{color:w,width:z,dash:"dashdot"},hoverinfo:"skip"})}j.push({type:"line",x0:18,x1:216,y0:o,y1:o,opacity:.25,line:{width:.5}});const R=((X=i.quantities.bands)==null?void 0:X.cutoffs)||[],k=[R],P=["E<sub>wfc</sub> = %{customdata[0]} Ry<br>"];let y=1;if(F.length){k.push(F);let t=`δω = %{customdata[${y}]:.3f}`;y+=1,D.length&&(k.push(D),t+=` &plusmn; %{customdata[${y}]:.1e}`,y+=1),t+="%<br>",P.push(t)}O.length&&(k.push(O),P.push(`δV<sub>press</sub> = %{customdata[${y}]:.3f}%<br>`),y+=1),A.length&&(k.push(A),P.push(`δE<sub>coh</sub> = %{customdata[${y}]:.3f} meV<br>`),y+=1),q.length&&(k.push(q),P.push(`δv = %{customdata[${y}]:.3f}`),y+=1),f.push({x:R,y:new Array(R.length).fill(o),mode:"markers",marker:{size:24,opacity:0,line:{width:0}},showlegend:!1,customdata:R.map((t,n)=>k.map(u=>u[n])),hoverlabel:{bgcolor:"rgb(225, 225, 225)",bordercolor:"black"},hovertemplate:`<b>${i.name}</b><br>`+P.join("")+"<extra></extra>"});const{metadata:$}=i.quantities,J=$?`ν<sub>avg</sub> = ${$.avg_nu.toFixed(2)}<br>ν<sub>max</sub> = ${$.max_nu.toFixed(2)} (${$.max_conf})<br>ν<sub>avg</sub> (w/o XO3) = ${$.ang_nu.toFixed(2)}`:"not all EOS valid";r.push({xref:"paper",x:-.1,y:o,text:`<b>${i.name}</b><br>Z<sub>val</sub> = ${i.Z}<br>${J}`,showarrow:!1,align:"left",font:{size:10}}),g.forEach(t=>{if(l[t].pseudopotential===i.name&&l[t].Z===i.Z){const n=l[t].cutoff_wfc;let u,h,V,I;t==="efficiency"?(u="rect",h=.5,V="lightgreen",I="green"):(u="circle",h=.4,V="lightcoral",I="red"),j.push({type:u,xref:"x",yref:"y",x0:n-Z*h*2,x1:n+Z*h*2,y0:b[m]-s*h,y1:b[m]+s*h,fillcolor:V,line:{width:1,color:I},opacity:.5})}})}),ge.forEach((i,m)=>{f.push({name:i,type:"scatter",mode:"lines+markers",x:[NaN],y:[NaN],line:{color:"black",width:z,dash:ye[m]},marker:{size:Q,symbol:be[m]},showlegend:!0,legendgroup:i,hoverinfo:"skip"})});const C={title:{text:`Verification summary: ${c} (${d})`},xaxis:{title:{text:`Wavefunction cutoff [Ry]; Charge density cutoff [Ry] = ${v} x Ewfc (PAW/US) | 4 x Ewfc (NC); q-point = [0.5, 0.5, 0.5]`},showgrid:!1,showline:!0,mirror:!0,tickvals:[...Array.from({length:18},(i,m)=>m*10+30)],ticks:"inside",ticklen:5,range:[18,216],fixedrange:!0},yaxis:{side:"right",title:{text:"Error w.r.t. ref. wavefunction cutoff"},zeroline:!1,showgrid:!1,showline:!0,mirror:!0,ticks:"inside",ticklen:5,tickmode:"array",tickvals:b,ticktext:b.map(()=>"0"),range:[-5,(p.length-1)*T+5],fixedrange:!0},showlegend:!0,legend:{x:1.05,y:1,xanchor:"left",yanchor:"top",font:{size:_,color:"black"},bordercolor:"lightgrey",borderwidth:1},annotations:r,shapes:j,hovermode:"closest",height:E,margin:{l:160,r:80,t:40,b:80}};return{data:f,layout:C}}function L(c,d){return{name:c.label,type:"scatter",mode:"lines+markers",line:{color:d,width:z,dash:c.dash},marker:{size:Q,symbol:c.symbol},showlegend:!1,legendgroup:c.label,hoverinfo:"skip"}}const we={responsive:!0,displayModeBar:!1,displaylogo:!1},_e=({element:c,pseudosMetadata:d})=>{const[g,l]=x.useState(!0),{libraries:p}=x.useContext(K),{elementsInfo:S}=x.useContext(Y),[s,b]=x.useState({}),E=x.useRef(null),v=x.useMemo(()=>!s||!s.pseudos?[]:s.pseudos.filter(r=>d.hasOwnProperty(r.name)),[s,d]),f=x.useMemo(()=>Object.fromEntries(Object.entries(S).map(([r,j])=>[r,j[c]])),[S,c]);return x.useEffect(()=>{l(!0),ee.fetchPseudosSummaryData(c).then(r=>{b(r)}).catch(r=>{console.error("Error fetching data:",r),b({})}).finally(()=>{l(!1)})},[c]),x.useEffect(()=>{if(g||!v.length||!E.current)return;let r=null,j=!1,C=null;return(async()=>{if(r=(await te(async()=>{const{default:w}=await import("./PlotlyLoader-O4gGgQGB.js");return{default:w}},__vite__mapDeps([0,1,2,3]))).default,j||!E.current)return;const{data:i,layout:m}=ve(c,s.conff,p,f,v,d);C=await r.react(E.current,i,m,we)})(),()=>{if(j=!0,r&&C)try{r.purge(C)}catch(i){console.error("Error purging ConvergencePlot:",i)}}},[g,v,d]),g?e.jsx(G,{}):v.length?e.jsx("div",{ref:E,id:le["convergence-plot"]}):e.jsx(ne,{})},B={"convergence-plot-container":"_convergence-plot-container_87fdm_1","convergence-plot-description":"_convergence-plot-description_87fdm_1"},je=({element:c})=>{const{loadingMetadata:d,categories:g,pseudosMetadata:l}=x.useContext(se),[p,S]=x.useState(g),s=x.useMemo(()=>{const b={};return Object.entries(l).forEach(([E,v])=>{p.includes(v.category)&&(b[E]=v)}),b},[p]);return d?e.jsx(G,{}):e.jsxs("div",{id:"convergence-summary",children:[e.jsxs("div",{id:B["convergence-plot-description"],children:[e.jsx("h5",{children:"Convergence pattern plots according to the SSSP protocol"}),e.jsx("p",{children:"We report here the zone-boundary phonons, cohesive energy, pressure, and band structure versus the wavefunction cutoff for all the considered pseudopotential libraries."}),e.jsxs("p",{children:["The colored horizontal dashed lines correspond to the thresholds of the SSSP efficiency criteria, whereas the gray dotted lines correspond to the precision criteria. The recommended efficiency (precision) pseudopotential is marked with a colored"," ",e.jsx("span",{style:{color:"green"},children:"square"})," (",e.jsx("span",{style:{color:"red"},children:"circle"}),") at the recommended cutoff."]}),"On the left, we report:",e.jsxs("ul",{children:[e.jsx("li",{children:"the number of valence electrons of the pseudopotential"}),e.jsxs("li",{children:["the average of ",e.jsx("b",{children:"ν"}),", a *metric relating to the equation of state, across 10 structures"]}),e.jsxs("li",{children:["the maximum ",e.jsx("b",{children:"ν"})," value"]}),e.jsxs("li",{children:["the average of ",e.jsx("b",{children:"ν"}),", excluding the XO",e.jsx("sub",{children:"3"})," structure"]})]}),e.jsxs("p",{children:["*See the ",e.jsx("b",{children:"About"})," tab of the"," ",e.jsx("a",{href:"https://acwf-verification.materialscloud.org/",target:"_blank",style:{textDecoration:"none"},children:"Verification of the precision of DFT implementations via AiiDA common workflows"})," ","app to learn more about how ",e.jsx("b",{children:"ν"})," is computed."]}),e.jsxs("p",{children:["All calculations are performed on the ground-state elemental solids unless stated otherwise (i.e. rare-earths and flourine). See"," ",e.jsx(oe,{to:"/about",style:{textDecoration:"none"},children:"About SSSP"})," ","for more details."]})]}),e.jsx("hr",{}),e.jsx(ce,{categories:g,activeCategories:p,onCategorySelect:S}),e.jsx("div",{id:B["convergence-plot-container"],children:e.jsx(_e,{element:c,pseudosMetadata:s})})]})};export{je as default};
