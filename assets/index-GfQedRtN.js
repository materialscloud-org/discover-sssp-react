const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-DdbY3o2d.js","assets/index-BH0wW1rV.js","assets/index-Cjp2Xj_Y.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{l as fe,r as c,V as he,n as te,o as me,W as xe,p as pe,x as H,y as z,X as ge,Y as ve,K as je,u as F,j as s,a as P,z as se,Z as ye,F as X,$ as U,a0 as we,q as Ee,P as be,D as A,_ as Oe,M as ke,S as Re,L as _e,Q as Z,U as L}from"./index-BH0wW1rV.js";import{F as K,N as Ce}from"./NoDataMessage-D8qgxloP.js";import{a as Ne,i as Te,u as W,r as Se,h as q,f as Fe}from"./utils-ChtiUxCU.js";const V=2**31-1;function ne(e,t,n){const l=n-Date.now();e.current=l<=V?setTimeout(t,l):setTimeout(()=>ne(e,t,n),V)}function Me(){const e=fe(),t=c.useRef();return Ne(()=>clearTimeout(t.current)),c.useMemo(()=>{const n=()=>clearTimeout(t.current);function l(a,r=0){e()&&(n(),r<=V?t.current=setTimeout(a,r):ne(t,a,Date.now()+r))}return{set:l,clear:n,handleRef:t}},[])}const Pe=()=>{};function $e(e,t,{disabled:n,clickTrigger:l}={}){const a=t||Pe;he(e,a,{disabled:n,clickTrigger:l});const r=te(o=>{Te(o)&&a(o)});c.useEffect(()=>{if(n||e==null)return;const o=me(xe(e));let m=(o.defaultView||window).event;const d=pe(o,"keyup",u=>{if(u===m){m=void 0;return}r(u)});return()=>{d()}},[e,n,r])}const oe=c.forwardRef((e,t)=>{const{flip:n,offset:l,placement:a,containerPadding:r,popperConfig:o={},transition:m,runTransition:d}=e,[u,v]=H(),[j,f]=H(),x=z(v,t),p=W(e.container),h=W(e.target),[i,y]=c.useState(!e.show),g=ge(h,u,ve({placement:a,enableEvents:!!e.show,containerPadding:r||5,flip:n,offset:l,arrowElement:j,popperConfig:o}));e.show&&i&&y(!1);const O=(...$)=>{y(!0),e.onExited&&e.onExited(...$)},R=e.show||!i;if($e(u,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!R)return null;const{onExit:k,onExiting:b,onEnter:w,onEntering:E,onEntered:N}=e;let C=e.children(Object.assign({},g.attributes.popper,{style:g.styles.popper,ref:x}),{popper:g,placement:a,show:!!e.show,arrowProps:Object.assign({},g.attributes.arrow,{style:g.styles.arrow,ref:f})});return C=Se(m,d,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:C,onExit:k,onExiting:b,onExited:O,onEnter:w,onEntering:E,onEntered:N}),p?je.createPortal(C,p):null});oe.displayName="Overlay";const re=c.forwardRef(({className:e,bsPrefix:t,as:n="div",...l},a)=>(t=F(t,"popover-header"),s.jsx(n,{ref:a,className:P(e,t),...l})));re.displayName="PopoverHeader";const I=c.forwardRef(({className:e,bsPrefix:t,as:n="div",...l},a)=>(t=F(t,"popover-body"),s.jsx(n,{ref:a,className:P(e,t),...l})));I.displayName="PopoverBody";function ae(e,t){let n=e;return e==="left"?n=t?"end":"start":e==="right"&&(n=t?"start":"end"),n}function le(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const Be=c.forwardRef(({bsPrefix:e,placement:t="right",className:n,style:l,children:a,body:r,arrowProps:o,hasDoneInitialMeasure:m,popper:d,show:u,...v},j)=>{const f=F(e,"popover"),x=se(),[p]=(t==null?void 0:t.split("-"))||[],h=ae(p,x);let i=l;return u&&!m&&(i={...l,...le(d==null?void 0:d.strategy)}),s.jsxs("div",{ref:j,role:"tooltip",style:i,"x-placement":p,className:P(n,f,p&&`bs-popover-${h}`),...v,children:[s.jsx("div",{className:"popover-arrow",...o}),r?s.jsx(I,{children:a}):a]})}),Le=Object.assign(Be,{Header:re,Body:I,POPPER_OFFSET:[0,8]}),ce=c.forwardRef(({bsPrefix:e,placement:t="right",className:n,style:l,children:a,arrowProps:r,hasDoneInitialMeasure:o,popper:m,show:d,...u},v)=>{e=F(e,"tooltip");const j=se(),[f]=(t==null?void 0:t.split("-"))||[],x=ae(f,j);let p=l;return d&&!o&&(p={...l,...le(m==null?void 0:m.strategy)}),s.jsxs("div",{ref:v,style:p,role:"tooltip","x-placement":f,className:P(n,e,`bs-tooltip-${x}`),...u,children:[s.jsx("div",{className:"tooltip-arrow",...r}),s.jsx("div",{className:`${e}-inner`,children:a})]})});ce.displayName="Tooltip";const ie=Object.assign(ce,{TOOLTIP_OFFSET:[0,6]});function De(e){const t=c.useRef(null),n=F(void 0,"popover"),l=F(void 0,"tooltip"),a=c.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(t.current){if(q(t.current,n))return Le.POPPER_OFFSET;if(q(t.current,l))return ie.TOOLTIP_OFFSET}return[0,0]}}}),[e,n,l]);return[t,[a]]}function Ue(e,t){const{ref:n}=e,{ref:l}=t;e.ref=n.__wrapped||(n.__wrapped=a=>n(U(a))),t.ref=l.__wrapped||(l.__wrapped=a=>l(U(a)))}const de=c.forwardRef(({children:e,transition:t=X,popperConfig:n={},rootClose:l=!1,placement:a="top",show:r=!1,...o},m)=>{const d=c.useRef({}),[u,v]=c.useState(null),[j,f]=De(o.offset),x=z(m,j),p=t===!0?X:t||void 0,h=te(i=>{v(i),n==null||n.onFirstUpdate==null||n.onFirstUpdate(i)});return ye(()=>{u&&o.target&&(d.current.scheduleUpdate==null||d.current.scheduleUpdate())},[u,o.target]),c.useEffect(()=>{r||v(null)},[r]),s.jsx(oe,{...o,ref:x,popperConfig:{...n,modifiers:f.concat(n.modifiers||[]),onFirstUpdate:h},transition:p,rootClose:l,placement:a,show:r,children:(i,{arrowProps:y,popper:g,show:O})=>{var R,k;Ue(i,y);const b=g==null?void 0:g.placement,w=Object.assign(d.current,{state:g==null?void 0:g.state,scheduleUpdate:g==null?void 0:g.update,placement:b,outOfBoundaries:(g==null||(R=g.state)==null||(k=R.modifiersData.hide)==null?void 0:k.isReferenceHidden)||!1,strategy:n.strategy}),E=!!u;return typeof e=="function"?e({...i,placement:b,show:O,...!t&&O&&{className:"show"},popper:w,arrowProps:y,hasDoneInitialMeasure:E}):c.cloneElement(e,{...i,placement:b,arrowProps:y,popper:w,hasDoneInitialMeasure:E,className:P(e.props.className,!t&&O&&"show"),style:{...e.props.style,...i.style}})}})});de.displayName="Overlay";function Ve(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function Y(e,t,n){const[l]=t,a=l.currentTarget,r=l.relatedTarget||l.nativeEvent[n];(!r||r!==a)&&!Ee(a,r)&&e(...t)}be.oneOf(["click","hover","focus"]);const ze=({trigger:e=["hover","focus"],overlay:t,children:n,popperConfig:l={},show:a,defaultShow:r=!1,onToggle:o,delay:m,placement:d,flip:u=d&&d.indexOf("auto")!==-1,...v})=>{const j=c.useRef(null),f=z(j,n.ref),x=Me(),p=c.useRef(""),[h,i]=we(a,r,o),y=Ve(m),{onFocus:g,onBlur:O,onClick:R}=typeof n!="function"?c.Children.only(n).props:{},k=_=>{f(U(_))},b=c.useCallback(()=>{if(x.clear(),p.current="show",!y.show){i(!0);return}x.set(()=>{p.current==="show"&&i(!0)},y.show)},[y.show,i,x]),w=c.useCallback(()=>{if(x.clear(),p.current="hide",!y.hide){i(!1);return}x.set(()=>{p.current==="hide"&&i(!1)},y.hide)},[y.hide,i,x]),E=c.useCallback((..._)=>{b(),g==null||g(..._)},[b,g]),N=c.useCallback((..._)=>{w(),O==null||O(..._)},[w,O]),C=c.useCallback((..._)=>{i(!h),R==null||R(..._)},[R,i,h]),$=c.useCallback((..._)=>{Y(b,_,"fromElement")},[b]),ue=c.useCallback((..._)=>{Y(w,_,"toElement")},[w]),B=e==null?[]:[].concat(e),T={ref:k};return B.indexOf("click")!==-1&&(T.onClick=C),B.indexOf("focus")!==-1&&(T.onFocus=E,T.onBlur=N),B.indexOf("hover")!==-1&&(T.onMouseOver=$,T.onMouseOut=ue),s.jsxs(s.Fragment,{children:[typeof n=="function"?n(T):c.cloneElement(n,T),s.jsx(de,{...v,show:h,onHide:w,flip:u,placement:d,popperConfig:l,target:j.current,children:t})]})},G={"eos-note":"_eos-note_b5i6i_1"},Ae={"eos-plot":"_eos-plot_1kkbs_1"},Ie=e=>e.split(/(\d+)/).map((t,n)=>/\d+/.test(t)?s.jsx("sub",{children:t},n):t),He=(e,t,n,l,a)=>e.map(r=>{const o=Math.pow(r/t,.6666666666666666);return n+9*l*t/16*(Math.pow(o-1,3)*a+Math.pow(o-1,2)*(6-4*o))}),Q=1e3,M=2,Xe={displaylogo:!1,responsive:!0,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","autoScale2d","lasso2d","select2d"]},Ze=({configuration:e,eosPseudosMap:t,activePseudos:n})=>{const{pseudosMetadata:l}=c.useContext(A),a=c.useRef(null);return c.useEffect(()=>{if(!a.current)return;let r=null,o=null,m=!1,d=null;const u=Object.values(t).flatMap(f=>f.volumes||[]),v=Math.min(...u),j=Math.max(...u);return(async()=>{if(r=(await Oe(async()=>{const{default:h}=await import("./PlotlyLoader-DdbY3o2d.js");return{default:h}},__vite__mapDeps([0,1,2,3]))).default,m||!a.current)return;const f=Object.entries(t).filter(([h])=>n.includes(h)).map(([h,i])=>{var O,R;const y=h.split("-Z=")[0],g=((O=l[y])==null?void 0:O.color)||"black";if(h!=="REF"&&i.volumes&&i.energies){const k=i.volumes.map((E,N)=>{var C;return{volume:E,energy:(((C=i.energies)==null?void 0:C[N])||0)-((i==null?void 0:i.E0)||0)}}).sort((E,N)=>E.volume-N.volume),b=k.map(E=>E.volume),w=k.map(E=>E.energy);return{x:b,y:w,mode:"lines+markers",type:"scatter",line:{shape:"spline"},name:h,marker:{color:g},hovertemplate:h+`<br>Volume = %{x:.${M}f} Å³/atom<br>Energy = %{y:.${M}f} eV/atom`+(i.nu?`<br>ν = ${(R=i.nu)==null?void 0:R.toFixed(M)}`:"")+"<extra></extra>",hoverlabel:{align:"left"}}}else{const k=Array.from({length:Q},(b,w)=>v+w*(j-v)/(Q-1));return{x:k,y:He(k,i.V0,0,i.B0,i.B1),mode:"lines",type:"scatter",line:{color:g},name:h,hovertemplate:h+`<br>Volume = %{x:.${M}f} Å³/atom<br>Energy = %{y:.${M}f} eV/atom<extra></extra>`,hoverlabel:{align:"left"}}}}),x={title:{text:Fe(e),x:.55,y:.9},xaxis:{title:{text:"Volume [Å³/atom]",standoff:10},showgrid:!1},yaxis:{title:{text:"Energy [eV/atom]"},showgrid:!1},showlegend:!1,margin:{l:70,r:20,t:30,b:40},autosize:!0};o=await r.react(a.current,f,x,Xe);const p=h=>{h&&r.Plots.resize(h)};d=()=>p(o),window.addEventListener("resize",d),d()})(),()=>{if(m=!0,d&&window.removeEventListener("resize",d),r&&o)try{r.purge(o)}catch(f){console.error("Error purging EosPlot:",f)}}},[n]),s.jsx("div",{ref:a,className:Ae["eos-plot"]})},Ke="_gap_1g19a_18",We="_nuTd_1g19a_27",S={gap:Ke,nuTd:We},J=["SC","BCC","FCC","DC","XO","XO2","XO3","X2O","X2O3","X2O5"],qe=({eosPseudosMap:e})=>s.jsxs(ke,{borderless:!0,responsive:!0,className:"text-center",children:[s.jsxs("thead",{children:[s.jsxs("tr",{children:[s.jsx("th",{rowSpan:2,children:"Library"}),s.jsxs("th",{rowSpan:2,children:["Z",s.jsx("sub",{children:"val"})]}),s.jsx("td",{rowSpan:2,className:S.gap}),s.jsx("th",{colSpan:2,children:"Rho Cutoff"}),s.jsx("td",{rowSpan:2,className:S.gap}),s.jsx("th",{colSpan:10,children:"ν"}),s.jsx("td",{rowSpan:2,className:S.gap}),s.jsx("th",{colSpan:2,children:"Average ν"})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Efficiency"}),s.jsx("th",{children:"Precision"}),J.map(t=>s.jsx("th",{children:Ie(t)},t)),s.jsx("th",{className:"text-nowrap",children:"w/ max"}),s.jsx("th",{className:"text-nowrap",children:"w/o max"})]})]}),s.jsx("tbody",{children:e&&Object.entries(e).filter(([t])=>t.includes("-Z=")).map(([t,n])=>{const[l,a]=t.split("-Z=");return s.jsxs("tr",{children:[s.jsx("td",{children:l}),s.jsx("td",{children:a}),s.jsx("td",{className:S.gap}),Object.entries(e[t].ecutrho).map(([r,o])=>s.jsx("td",{children:o?o.toFixed(2):"-"},r)),s.jsx("td",{className:S.gap}),J.map(r=>{var d,u;const o=(d=n.configurations[r])==null?void 0:d.nu,m=(u=n.configurations[r])==null?void 0:u.uuid;return s.jsx("td",{style:{backgroundColor:ee(o)},className:o!==void 0?S.nuTd:void 0,children:o!==void 0?s.jsx("a",{href:`https://www.materialscloud.org/explore/sssp-v2/${m}`,target:"_blank",className:"link-dark stretched-link sssp-link",children:o.toFixed(2)}):"-"},r)}),s.jsx("td",{className:S.gap}),Object.entries(e[t].avgNu).map(([r,o])=>s.jsx("td",{style:{backgroundColor:ee(o)},children:o!==void 0?o.toFixed(2):"-"},r))]},t)})})]}),ee=e=>e===void 0?"white":e<=.1?"#B7E1CD":e>=.33?"#EA9999":"#FFE599",D={"pseudos-checkboxes":"_pseudos-checkboxes_cplvb_1","pseudo-checkbox":"_pseudo-checkbox_cplvb_5"},Ye=({pseudos:e,activePseudos:t,setActivePseudos:n})=>{const{pseudosMetadata:l}=c.useContext(A),[a,r]=c.useState(!1);return c.useEffect(()=>{r(t.length===e.length)},[t,e.length]),s.jsxs("div",{className:D["pseudos-checkboxes"],children:[s.jsx(K.Check,{type:"checkbox",id:"all",label:"Select all",checked:a,className:D["pseudo-checkbox"],style:{color:"black"},onChange:o=>{n(o.target.checked?e:["REF"]),r(o.target.checked)}}),e.map(o=>{var u;const m=o+(o==="REF"?" (AE average)":""),d=o.split("-Z=")[0];return s.jsx(K.Check,{type:"checkbox",id:o,label:s.jsx(ze,{placement:"right",delay:{show:100,hide:100},offset:[0,10],overlay:s.jsx(ie,{children:m}),children:s.jsx("span",{children:m})}),checked:t.includes(o),disabled:o==="REF",className:D["pseudo-checkbox"],style:{color:((u=l[d])==null?void 0:u.color)||"black"},onChange:v=>{n(v.target.checked?[...t,o]:t.filter(j=>j!==o)),r(v.target.checked?t.length+1===e.length:!1)}},o)})]})},et=({element:e})=>{const{loadingMetadata:t}=c.useContext(A),[n,l]=c.useState(!0),[a,r]=c.useState({}),[o,m]=c.useState([]),[d,u]=c.useState([]),v=c.useMemo(()=>{const f={};return Object.entries(a).forEach(([x,p])=>{Object.entries(p.configurations).forEach(([h,i])=>{f[h]||(f[h]={}),f[h][x]=i})}),f},[a]);return c.useEffect(()=>{e&&(l(!0),r({}),m([]),u([]),Re.fetchEosData().then(f=>{const x=f[e];r(x);const p=Object.keys(x);m(p),u(p)}).catch(f=>{console.error("Error fetching EOS data:",f),r({}),m([]),u([])}).finally(()=>l(!1)))},[e]),n||t?s.jsx(_e,{}):o.length?s.jsxs("div",{id:"eos-pane",children:[s.jsx("div",{id:"eos-plots",children:s.jsxs(Z,{children:[s.jsx(L,{md:4,lg:3,xxl:2,className:G["pseudo-controls"],children:s.jsx(Ye,{pseudos:o,activePseudos:d,setActivePseudos:u})}),s.jsxs(L,{children:[s.jsx(Z,{children:Object.entries(v).map(([f,x])=>s.jsx(L,{lg:6,xl:4,xxl:3,children:s.jsx(Ze,{configuration:f,eosPseudosMap:x,activePseudos:d})},f))}),s.jsxs("div",{id:G["eos-note"],children:["Comparison of equations of state for different pseudopotentials and their Birch-Murnaghan fits.",s.jsx("br",{}),'"REF (AE average)" refers to the all-electron average values from the reference dataset published in'," ",s.jsxs("a",{href:"https://www.nature.com/articles/s42254-023-00655-3",target:"_blank",children:["Bosoni et al., ",s.jsx("em",{children:"Nature Reviews Physics"})," ",s.jsx("b",{children:"6"}),", 45-58 (2024)"]})]})]})]})}),s.jsx("hr",{}),s.jsx(qe,{eosPseudosMap:a})]}):s.jsx(Ce,{})};export{et as default};
