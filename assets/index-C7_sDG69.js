const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-fgMZOF-g.js","assets/index-woou4hVf.js","assets/index-FuAJ-oR5.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{T as se,r as i,c as I,j as e,a as fe,t as pe,b as $,s as oe,d as xe,E as me,e as ge,f as ye,g as be,u as R,h as je,L as ve,i as we,S as Ee,_ as _e,k as re,P as Se,l as Ce}from"./index-woou4hVf.js";import{F as ke,N as Ae}from"./NoDataMessage-0Iu3XdJR.js";const $e={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Ne(s,o){const r=`offset${s[0].toUpperCase()}${s.slice(1)}`,n=o[r],a=$e[s];return n+parseInt(oe(o,a[0]),10)+parseInt(oe(o,a[1]),10)}const Re={[be]:"collapse",[ye]:"collapsing",[ge]:"collapsing",[me]:"collapse show"},Fe=se.forwardRef(({onEnter:s,onEntering:o,onEntered:r,onExit:n,onExiting:a,className:h,children:t,dimension:d="height",in:u=!1,timeout:j=300,mountOnEnter:f=!1,unmountOnExit:c=!1,appear:_=!1,getDimensionValue:C=Ne,...x},E)=>{const m=typeof d=="function"?d():d,p=i.useMemo(()=>I(b=>{b.style[m]="0"},s),[m,s]),g=i.useMemo(()=>I(b=>{const A=`scroll${m[0].toUpperCase()}${m.slice(1)}`;b.style[m]=`${b[A]}px`},o),[m,o]),N=i.useMemo(()=>I(b=>{b.style[m]=null},r),[m,r]),F=i.useMemo(()=>I(b=>{b.style[m]=`${C(m,b)}px`,xe(b)},n),[n,C,m]),D=i.useMemo(()=>I(b=>{b.style[m]=null},a),[m,a]);return e.jsx(fe,{ref:E,addEndListener:pe,...x,"aria-expanded":x.role?u:null,onEnter:p,onEntering:g,onEntered:N,onExit:F,onExiting:D,childRef:t.ref,in:u,timeout:j,mountOnEnter:f,unmountOnExit:c,appear:_,children:(b,A)=>se.cloneElement(t,{...A,className:$(h,t.props.className,Re[b],m==="width"&&"collapse-horizontal")})})});function ae(s,o){return Array.isArray(s)?s.includes(o):s===o}const q=i.createContext({});q.displayName="AccordionContext";const Y=i.forwardRef(({as:s="div",bsPrefix:o,className:r,children:n,eventKey:a,...h},t)=>{const{activeEventKey:d}=i.useContext(q);return o=R(o,"accordion-collapse"),e.jsx(Fe,{ref:t,in:ae(d,a),...h,className:$(r,o),children:e.jsx(s,{children:i.Children.only(n)})})});Y.displayName="AccordionCollapse";const W=i.createContext({eventKey:""});W.displayName="AccordionItemContext";const ce=i.forwardRef(({as:s="div",bsPrefix:o,className:r,onEnter:n,onEntering:a,onEntered:h,onExit:t,onExiting:d,onExited:u,...j},f)=>{o=R(o,"accordion-body");const{eventKey:c}=i.useContext(W);return e.jsx(Y,{eventKey:c,onEnter:n,onEntering:a,onEntered:h,onExit:t,onExiting:d,onExited:u,children:e.jsx(s,{ref:f,...j,className:$(r,o)})})});ce.displayName="AccordionBody";function De(s,o){const{activeEventKey:r,onSelect:n,alwaysOpen:a}=i.useContext(q);return h=>{let t=s===r?null:s;a&&(Array.isArray(r)?r.includes(s)?t=r.filter(d=>d!==s):t=[...r,s]:t=[s]),n==null||n(t,h),o==null||o(h)}}const J=i.forwardRef(({as:s="button",bsPrefix:o,className:r,onClick:n,...a},h)=>{o=R(o,"accordion-button");const{eventKey:t}=i.useContext(W),d=De(t,n),{activeEventKey:u}=i.useContext(q);return s==="button"&&(a.type="button"),e.jsx(s,{ref:h,onClick:d,...a,"aria-expanded":Array.isArray(u)?u.includes(t):t===u,className:$(r,o,!ae(u,t)&&"collapsed")})});J.displayName="AccordionButton";const ie=i.forwardRef(({as:s="h2",bsPrefix:o,className:r,children:n,onClick:a,...h},t)=>(o=R(o,"accordion-header"),e.jsx(s,{ref:t,...h,className:$(r,o),children:e.jsx(J,{onClick:a,children:n})})));ie.displayName="AccordionHeader";const le=i.forwardRef(({as:s="div",bsPrefix:o,className:r,eventKey:n,...a},h)=>{o=R(o,"accordion-item");const t=i.useMemo(()=>({eventKey:n}),[n]);return e.jsx(W.Provider,{value:t,children:e.jsx(s,{ref:h,...a,className:$(r,o)})})});le.displayName="AccordionItem";const de=i.forwardRef((s,o)=>{const{as:r="div",activeKey:n,bsPrefix:a,className:h,onSelect:t,flush:d,alwaysOpen:u,...j}=je(s,{activeKey:"onSelect"}),f=R(a,"accordion"),c=i.useMemo(()=>({activeEventKey:n,onSelect:t,alwaysOpen:u}),[n,t,u]);return e.jsx(q.Provider,{value:c,children:e.jsx(r,{ref:o,...j,className:$(h,f,d&&`${f}-flush`)})})});de.displayName="Accordion";const L=Object.assign(de,{Button:J,Collapse:Y,Item:le,Header:ie,Body:ce}),Oe=i.forwardRef(({bsPrefix:s,className:o,striped:r,bordered:n,borderless:a,hover:h,size:t,variant:d,responsive:u,...j},f)=>{const c=R(s,"table"),_=$(o,c,d&&`${c}-${d}`,t&&`${c}-${t}`,r&&`${c}-${typeof r=="string"?`striped-${r}`:"striped"}`,n&&`${c}-bordered`,a&&`${c}-borderless`,h&&`${c}-hover`),C=e.jsx("table",{...j,className:_,ref:f});if(u){let x=`${c}-responsive`;return typeof u=="string"&&(x=`${x}-${u}`),e.jsx("div",{className:x,children:C})}return C}),Te={"category-selector":"_category-selector_1aq5o_1"},ze={nc:"Norm-conserving",us:"Ultrasoft",paw:"PAW"},Ie=({categories:s,activeCategories:o,onCategorySelect:r})=>e.jsx("div",{className:Te["category-selector"],children:s.map(n=>e.jsx(ke.Check,{type:"checkbox",id:`category-${n}`,label:ze[n]||n,checked:o.includes(n),onChange:a=>a.target.checked?r([...o,n]):r(o.filter(h=>h!==n))},n))}),Me={"convergence-plot":"_convergence-plot_b9eda_1"},Z=1.2,K=1.3,V=.13,he=6,M=1,k=10,qe=40,Pe=80,ne=2,B=8,Le=120,Ve=new Set(["O","Fe","Mn","Hf","Co","Ni","Cr"]),Be=.2,He=2,Ue=1,We=["δω","δV<sub>press</sub>","δE<sub>coh</sub>","δν"],Xe=["circle","triangle-down","star","square"],Ge=["solid","dash","dot","solid"],H={phononFrequencies:{label:"δω",symbol:"circle",dash:"solid"},pressure:{label:"δV<sub>press</sub>",symbol:"triangle-down",dash:"dash"},cohesiveEnergy:{label:"δE<sub>coh</sub>",symbol:"star",dash:"dot"},eos:{label:"δν",symbol:"square",dash:"solid"}};function Ze(s,o,r,n,a,h){const t=B/4,d=a.map((x,E)=>E*B),u=a.length*Le+(qe+Pe),j=Ve.has(s)?18:8,f=[],c=[],_=[];a.reverse().forEach((x,E)=>{var ee,te;const m=((ee=h[x.name])==null?void 0:ee.color)||"black",p=E*B,{quantities:g}=x;let N=[],F=[],D=[],b=[],A=[];if(g.phononFrequencies){N=g.phononFrequencies.values.map(w=>w*2/He);let l=U(H.phononFrequencies,m);l.x=g.phononFrequencies.cutoffs,l.y=N.map(w=>w+p),F=g.phononFrequencies.error,l.error_y={type:"data",array:F,arrayminus:N.map(()=>0),visible:!0,color:m},f.push(l);const y=g.phononFrequencies.ref.toFixed(2);c.push({x:203.1,y:p-1,text:`ω<sub>max</sub> = ${y} cm<sup>-1</sup>`,showarrow:!1,font:{size:k}})}if(g.pressure){let l=U(H.pressure,m);D=g.pressure.values.map(y=>y*2/Ue),l.x=g.pressure.cutoffs,l.y=D.map(y=>y+p),f.push(l)}if(g.cohesiveEnergy){let l=U(H.cohesiveEnergy,m);b=g.cohesiveEnergy.values,l.x=g.cohesiveEnergy.cutoffs,l.y=b.map(w=>w+p),f.push(l);const y=g.cohesiveEnergy.ref.toFixed(2);c.push({x:205,y:p+1,text:`E<sub>coh</sub> = ${y} <i>meV/atom</i>`,showarrow:!1,font:{size:k}})}if(g.eos){let l=U(H.eos,m);A=g.eos.values.map(y=>y*2/Be),l.x=g.eos.cutoffs,l.y=A.map(y=>y+p),f.push(l)}if(g.bands){const l=g.bands.cutoffs,y=g.bands.eta_c,w=g.bands.max_diff_c;c.push({x:24,y:p+Z*t+V,text:"       <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:k}}),f.push({x:l,y:y.map(()=>p+Z*t),type:"scatter",mode:"text",text:y.map(v=>v.toFixed(2)),showlegend:!1,textfont:{size:k},hoverinfo:"skip"}),c.push({x:205,y:p+Z*t+V,text:"[meV]",showarrow:!1,align:"left",font:{size:k}}),f.push({x:[0,250],y:[p+t,p+t],type:"scatter",mode:"lines",text:y.map(v=>v.toFixed(2)),showlegend:!1,line:{color:m,width:M,dash:"dashdot"},hoverinfo:"skip"}),f.push({x:[0,250],y:[p+t/2,p+t/2],type:"scatter",mode:"lines",text:y.map(v=>v.toFixed(2)),showlegend:!1,line:{color:"lightgray",width:M,dash:"dot"},hoverinfo:"skip"}),c.push({x:24,y:p-K*t+V,text:"max <i>η</i><sub>10</sub> = ",showarrow:!1,align:"left",font:{size:k}}),f.push({x:l,y:w.map(()=>p-K*t),type:"scatter",mode:"text",text:w.map(v=>v.toFixed(2)),showlegend:!1,textfont:{size:k},hoverinfo:"skip"}),c.push({x:205,y:p-K*t+V,text:"[meV]",showarrow:!1,align:"left",font:{size:k}}),f.push({x:[0,250],y:[p-t,p-t],type:"scatter",mode:"lines",text:w.map(v=>v.toFixed(2)),showlegend:!1,line:{color:m,width:M,dash:"dashdot"},hoverinfo:"skip"})}_.push({type:"line",x0:18,x1:216,y0:p,y1:p,opacity:.25,line:{width:.5}});const P=((te=x.quantities.bands)==null?void 0:te.cutoffs)||[],O=[P],T=["E<sub>wfc</sub> = %{customdata[0]} Ry<br>"];let S=1;if(N.length){O.push(N);let l=`δω = %{customdata[${S}]:.3f}`;S+=1,F.length&&(O.push(F),l+=` &plusmn; %{customdata[${S}]:.1e}`,S+=1),l+="%<br>",T.push(l)}D.length&&(O.push(D),T.push(`δV<sub>press</sub> = %{customdata[${S}]:.3f}%<br>`),S+=1),b.length&&(O.push(b),T.push(`δE<sub>coh</sub> = %{customdata[${S}]:.3f} meV<br>`),S+=1),A.length&&(O.push(A),T.push(`δv = %{customdata[${S}]:.3f}`),S+=1),f.push({x:P,y:new Array(P.length).fill(p),mode:"markers",marker:{size:24,opacity:0,line:{width:0}},showlegend:!1,customdata:P.map((l,y)=>O.map(w=>w[y])),hoverlabel:{bgcolor:"rgb(225, 225, 225)",bordercolor:"black"},hovertemplate:`<b>${x.name}</b><br>`+T.join("")+"<extra></extra>"});const{metadata:z}=x.quantities,ue=z?`ν<sub>avg</sub> = ${z.avg_nu.toFixed(2)}<br>ν<sub>max</sub> = ${z.max_nu.toFixed(2)} (${z.max_conf})<br>ν<sub>avg</sub> (w/o XO3) = ${z.avg_nu_wo_xo3.toFixed(2)}`:"not all EOS valid";c.push({xref:"paper",x:-.1,y:p,text:`<b>${x.name}</b><br>Z<sub>val</sub> = ${x.Z}<br>${ue}`,showarrow:!1,align:"left",font:{size:10}}),r.forEach(l=>{if(n[l].pseudopotential===x.name&&n[l].Z===x.Z){const y=n[l].cutoff_wfc;let w,v,X,G;l==="efficiency"?(w="rect",v=.5,X="lightgreen",G="green"):(w="circle",v=.4,X="lightcoral",G="red"),_.push({type:w,xref:"x",yref:"y",x0:y-ne*v*2,x1:y+ne*v*2,y0:d[E]-t*v,y1:d[E]+t*v,fillcolor:X,line:{width:1,color:G},opacity:.5})}})}),We.forEach((x,E)=>{f.push({name:x,type:"scatter",mode:"lines+markers",x:[NaN],y:[NaN],line:{color:"black",width:M,dash:Ge[E]},marker:{size:he,symbol:Xe[E]},showlegend:!0,legendgroup:x,hoverinfo:"skip"})});const C={title:{text:`Verification summary: ${s} (${o})`},xaxis:{title:{text:`Wavefunction cutoff [Ry]; Charge density cutoff [Ry] = ${j} x Ewfc (PAW/US) | 4 x Ewfc (NC); q-point = [0.5, 0.5, 0.5]`},showgrid:!1,showline:!0,mirror:!0,tickvals:[...Array.from({length:18},(x,E)=>E*10+30)],ticks:"inside",ticklen:5,range:[18,216],fixedrange:!0},yaxis:{side:"right",title:{text:"Error w.r.t. ref. wavefunction cutoff"},zeroline:!1,showgrid:!1,showline:!0,mirror:!0,ticks:"inside",ticklen:5,tickmode:"array",tickvals:d,ticktext:d.map(()=>"0"),range:[-5,(a.length-1)*B+5],fixedrange:!0},showlegend:!0,legend:{x:1.05,y:1,xanchor:"left",yanchor:"top",font:{size:k,color:"black"},bordercolor:"lightgrey",borderwidth:1},annotations:c,shapes:_,hovermode:"closest",height:u,margin:{l:160,r:80,t:40,b:80}};return{data:f,layout:C}}function U(s,o){return{name:s.label,type:"scatter",mode:"lines+markers",line:{color:o,width:M,dash:s.dash},marker:{size:he,symbol:s.symbol},showlegend:!1,legendgroup:s.label,hoverinfo:"skip"}}const Ke={responsive:!0,displayModeBar:!1,displaylogo:!1},Qe=({element:s,pseudosMetadata:o})=>{const[r,n]=i.useState(!0),{libraries:a}=i.useContext(ve),{elementsInfo:h}=i.useContext(we),[t,d]=i.useState({}),u=i.useRef(null),j=i.useMemo(()=>!t||!t.pseudos?[]:t.pseudos.filter(c=>o.hasOwnProperty(c.name)),[t==null?void 0:t.pseudos,o]),f=i.useMemo(()=>Object.fromEntries(Object.entries(h).map(([c,_])=>[c,_[s]])),[h,s]);return i.useEffect(()=>{s&&(n(!0),d({}),Ee.fetchPseudosSummaryData(s).then(c=>{d(c)}).catch(c=>{console.error("Error fetching data:",c),d({})}).finally(()=>{n(!1)}))},[s]),i.useEffect(()=>{if(r||!j.length||!u.current)return;let c=!1;return(async()=>{const _=(await _e(async()=>{const{default:E}=await import("./PlotlyLoader-fgMZOF-g.js");return{default:E}},__vite__mapDeps([0,1,2,3]))).default;if(c||!u.current)return;const{data:C,layout:x}=Ze(s,t.conff,a,f,j,o);await _.react(u.current,C,x,Ke)})(),()=>{c=!0}},[r,s,t,a,f,j,o]),r?e.jsx(re,{}):j.length?e.jsx("div",{ref:u,id:Me["convergence-plot"]}):e.jsx(Ae,{})},Q={"convergence-plot-description":"_convergence-plot-description_857f8_1","convergence-plot-legend-table":"_convergence-plot-legend-table_857f8_1","convergence-plot-container":"_convergence-plot-container_857f8_1"},et=({element:s})=>{const{loadingMetadata:o,categories:r,pseudosMetadata:n}=i.useContext(Se),[a,h]=i.useState(r),t=i.useMemo(()=>{const d={};return Object.entries(n).forEach(([u,j])=>{a.includes(j.category)&&(d[u]=j)}),d},[a,n]);return o?e.jsx(re,{}):e.jsxs("div",{id:"convergence-summary",children:[e.jsx(L,{id:Q["convergence-plot-description"],children:e.jsxs(L.Item,{eventKey:"0",children:[e.jsx(L.Header,{children:"About the SSSP protocol convergence pattern plots"}),e.jsxs(L.Body,{children:[e.jsxs("section",{children:[e.jsx("p",{children:"We report here the zone-boundary phonons, cohesive energy, pressure, and band structure versus the wavefunction cutoff for all the considered pseudopotential libraries."}),e.jsxs("p",{children:["The colored horizontal dashed lines correspond to the thresholds of the SSSP efficiency criteria, whereas the gray dotted lines correspond to the precision criteria. ",e.jsx("br",{})," The recommended efficiency (precision) pseudopotential is marked with a colored"," ",e.jsx("span",{style:{color:"green"},children:"square"})," (",e.jsx("span",{style:{color:"red"},children:"circle"}),") at the recommended cutoff."]})]}),e.jsxs("section",{children:[e.jsx("h5",{children:"Metadata"}),"We report on the left of the plot:",e.jsxs("ul",{children:[e.jsx("li",{children:"the number of valence electrons of the pseudopotential"}),e.jsxs("li",{children:["the average of ",e.jsx("b",{children:"ν"}),", a *metric relating to the equation of state, across 10 structures"]}),e.jsxs("li",{children:["the maximum ",e.jsx("b",{children:"ν"})," value"]}),e.jsxs("li",{children:["the average of ",e.jsx("b",{children:"ν"}),", excluding the XO",e.jsx("sub",{children:"3"})," ","structure"]})]})]}),e.jsxs("section",{children:[e.jsx("h5",{children:"Legend"}),e.jsxs("p",{children:["Each pseudopotential is represented in its own color. The legend items are kept in black and reflect the corresponding quantity/discrepancy across all pseudopotentials.",e.jsx("br",{}),"The markers correspond to the following quantities:"]}),e.jsxs(Oe,{id:Q["convergence-plot-legend-table"],bordered:!0,striped:!0,responsive:!0,size:"sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Marker"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Units"}),e.jsx("th",{children:"Description"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"●"}),e.jsx("td",{children:"δω"}),e.jsx("td",{children:"%"}),e.jsx("td",{children:"Discrepancy in all phonon frequencies at the zone boundary"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"▼"}),e.jsxs("td",{children:["δV",e.jsx("sub",{children:"press"})]}),e.jsx("td",{children:"%"}),e.jsx("td",{children:"Discrepancy in pressure"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"★"}),e.jsxs("td",{children:["δE",e.jsx("sub",{children:"coh"})]}),e.jsx("td",{children:"meV"}),e.jsx("td",{children:"Discrepancy in cohesive energy"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"■"}),e.jsx("td",{children:"δν"}),e.jsx("td",{children:"-"}),e.jsx("td",{children:"Discrepancy in band structure"})]})]})]}),e.jsx("p",{children:"A single click on a legend item toggles its visibility, while a double click isolates it."})]}),e.jsxs("section",{children:[e.jsx("h5",{children:"Categories"}),e.jsx("p",{children:"You can use the pseudopotential category checkboxes to filter the pseudopotentials shown in the plots."})]}),e.jsxs("section",{children:[e.jsx("h5",{children:"Additional information"}),e.jsxs("p",{children:["See the ",e.jsx("b",{children:"About"})," tab of the"," ",e.jsx("a",{href:"https://acwf-verification.materialscloud.org/",target:"_blank",style:{textDecoration:"none"},children:"Verification of the precision of DFT implementations via AiiDA common workflows"})," ","app to learn more about how ",e.jsx("b",{children:"ν"})," is computed. ",e.jsx("br",{}),"All calculations are performed on the ground-state elemental solids unless stated otherwise (i.e. rare-earths and flourine). See"," ",e.jsx(Ce,{to:"/about",style:{textDecoration:"none"},children:"About SSSP"})," ","for more details."]})]})]})]})}),e.jsx(Ie,{categories:r,activeCategories:a,onCategorySelect:h}),e.jsx("div",{id:Q["convergence-plot-container"],children:e.jsx(Qe,{element:s,pseudosMetadata:t})})]})};export{et as default};
