const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/main-CD77xzpe.js","assets/index-BaRx3iXj.js","assets/index-CdNc5vnI.css"])))=>i.map(i=>d[i]);
import{r as c,u as w,j as e,a as L,a1 as z,O as b,Q as x,_ as R,D as V,S as $,L as F}from"./index-BaRx3iXj.js";import{F as p,N as q}from"./NoDataMessage-BuoMfKrp.js";const C=c.forwardRef(({bsPrefix:n,fluid:s=!1,as:r="div",className:o,...a},t)=>{const l=w(n,"container"),i=typeof s=="string"?`-${s}`:"-fluid";return e.jsx(r,{ref:t,...a,className:L(o,s?`${l}${i}`:l)})});C.displayName="Container";const v=({id:n,which:s,pseudos:r,value:o,onSelect:a})=>e.jsxs(p.Group,{id:n,children:[e.jsxs(p.Label,{htmlFor:`${s}-select`,children:[z(s),":"]}),e.jsx(p.Select,{id:`${s}-select`,value:o,onChange:t=>a(t.target.value),children:r.map(t=>e.jsx("option",{value:t,children:t},t))})]}),m={"band-structure-controls":"_band-structure-controls_1qzx4_1","compared-pseudo-selector":"_compared-pseudo-selector_1qzx4_1","reference-pseudo-selector":"_reference-pseudo-selector_1qzx4_1","pseudo-shift-range":"_pseudo-shift-range_1qzx4_1"},O=({pseudos:n,activePseudos:s,bandShift:r,onPseudoSelect:o,onBandShiftChange:a})=>e.jsxs("div",{id:m["band-structure-controls"],children:[e.jsxs(b,{className:"gap-3",children:[e.jsx(x,{sm:"6",lg:"12",children:e.jsx(v,{id:m["reference-pseudo-selector"],which:"reference",pseudos:n,value:s[0],onSelect:t=>{o([t,s[1]]),a(0)}})}),e.jsx(x,{children:e.jsx(v,{id:m["compared-pseudo-selector"],which:"compared",pseudos:n,value:s[1],onSelect:t=>{o([s[0],t]),a(0)}})})]}),e.jsxs(p.Group,{children:[e.jsx(p.Label,{htmlFor:m["pseudo-shift-range"],children:"Compared bands shift (eV):"}),e.jsxs(b,{style:{alignItems:"center"},children:[e.jsx(x,{xs:"8",sm:"9",md:"10",lg:"6",xl:"7",xxl:"8",children:e.jsx(p.Range,{id:m["pseudo-shift-range"],name:"pseudo-shift-range",value:r,min:-5,max:5,step:.001,onChange:t=>a(Number(t.target.value))})}),e.jsx(x,{children:e.jsx(p.Control,{name:"pseudo-shift-number",type:"number",value:r,min:-5,max:5,step:.001,onChange:t=>a(Number(t.target.value))})})]})]})]}),k={"bands-note":"_bands-note_m1aly_1"},B={"bands-plot-wrapper":"_bands-plot-wrapper_1hzls_1","bands-plot":"_bands-plot_1hzls_1"},M=({pseudosMetadata:n,bandsPseudosMap:s,activePseudos:r,bandShift:o})=>{const a=c.useRef(null);return c.useEffect(()=>{if(s&&a.current){const t=A(r,s,o,n);if(!t.length)return;let l=null;(async()=>(l=(await R(async()=>{const{BandsVisualiser:i}=await import("./main-CD77xzpe.js");return{BandsVisualiser:i}},__vite__mapDeps([0,1,2]))).BandsVisualiser,l(a.current,{bandsDataArray:t,settings:{showlegend:!1,yaxis:{range:[-20,20]}}})))()}},[r,s,n,o]),e.jsx("div",{id:B["bands-plot-wrapper"],children:e.jsx("div",{ref:a,id:B["bands-plot"]})})},A=(n,s,r,o)=>n.flatMap((a,t)=>{var f;const l=s[a];if(!l)return[];let i=-l.fermiLevel||0;return t===1&&(i+=r),[{bandsData:G(l,i),traceFormat:{line:{color:t===0?"black":((f=o[a])==null?void 0:f.color)||"red"}}}]}),G=(n,s)=>({...n,paths:n.paths.map(r=>({...r,values:r.values.map(o=>o.map(a=>a+s))}))}),T=({element:n,chessboardPseudos:s,bandShift:r})=>{const{loadingMetadata:o,pseudosMetadata:a}=c.useContext(V),[t,l]=c.useState(!0),[i,f]=c.useState({}),[h,j]=c.useState([]),[y,_]=c.useState(s),[g,S]=c.useState(r);c.useEffect(()=>{n&&(l(!0),f({}),j([]),$.fetchBandsData(n).then(d=>{f(d);const u=d&&Object.keys(d);j(u)}).catch(d=>{console.error("Error fetching bands data:",d),f({}),j([])}).finally(()=>{l(!1)}))},[n]),c.useEffect(()=>{const d=u=>u.length===2&&u.every(N=>h.includes(N));if(!h.length){_([]);return}_(u=>d(s)?s:d(u)?u:[h[0],h[0]])},[h,s,n]),c.useEffect(()=>S(g),[g]);const D=t||o,E=Object.keys(i||{}).length>0;return D?e.jsx(F,{}):E?e.jsxs(C,{id:"bands-plots",children:[e.jsxs(b,{children:[e.jsx(x,{lg:"3",children:e.jsx(O,{pseudos:h,activePseudos:y,bandShift:g,onPseudoSelect:_,onBandShiftChange:S})}),e.jsx(x,{lg:"auto",className:"ms-lg-5",children:e.jsx(M,{pseudosMetadata:a,bandsPseudosMap:i,activePseudos:y,bandShift:g})})]}),e.jsx("div",{id:k["bands-note"],children:"Electronic band structure along high-symmetry path. The reference energy (0 eV) corresponds to the Fermi level."})]}):e.jsx(q,{})};export{T as default};
