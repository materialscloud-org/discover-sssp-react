const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-Bz0pDYxL.js","assets/index-Ccu1TaaF.js","assets/index-QUG939OS.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{l as he,r as i,V as me,n as te,o as xe,W as pe,p as ge,x as I,y as V,X as ve,Y as je,K as ye,u as P,j as n,a as M,z as se,Z as be,F as Z,$ as X,a0 as we,q as Ee,P as _e,D as z,_ as Ce,J as ne,M as Oe,O as ke,L as Re,Q as K,U as D}from"./index-Ccu1TaaF.js";import{P as Ne,N as Te}from"./PlotPaneHeader-bZpDhy9o.js";import{a as Fe,i as Pe,u as W,r as Se,h as q,f as $e}from"./utils-CFvirIh0.js";import{F as Y}from"./Form-N0h8dr4Y.js";const A=2**31-1;function oe(e,s,t){const o=t-Date.now();e.current=o<=A?setTimeout(s,o):setTimeout(()=>oe(e,s,t),A)}function Me(){const e=he(),s=i.useRef();return Fe(()=>clearTimeout(s.current)),i.useMemo(()=>{const t=()=>clearTimeout(s.current);function o(a,l=0){e()&&(t(),l<=A?s.current=setTimeout(a,l):oe(s,a,Date.now()+l))}return{set:o,clear:t,handleRef:s}},[])}const Be=()=>{};function Le(e,s,{disabled:t,clickTrigger:o}={}){const a=s||Be;me(e,a,{disabled:t,clickTrigger:o});const l=te(r=>{Pe(r)&&a(r)});i.useEffect(()=>{if(t||e==null)return;const r=xe(pe(e));let d=(r.defaultView||window).event;const f=ge(r,"keyup",u=>{if(u===d){d=void 0;return}l(u)});return()=>{f()}},[e,t,l])}const re=i.forwardRef((e,s)=>{const{flip:t,offset:o,placement:a,containerPadding:l,popperConfig:r={},transition:d,runTransition:f}=e,[u,h]=I(),[j,g]=I(),v=V(h,s),x=W(e.container),m=W(e.target),[c,y]=i.useState(!e.show),p=ve(m,u,je({placement:a,enableEvents:!!e.show,containerPadding:l||5,flip:t,offset:o,arrowElement:j,popperConfig:r}));e.show&&c&&y(!1);const _=(...B)=>{y(!0),e.onExited&&e.onExited(...B)},O=e.show||!c;if(Le(u,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!O)return null;const{onExit:C,onExiting:E,onEnter:b,onEntering:w,onEntered:T}=e;let R=e.children(Object.assign({},p.attributes.popper,{style:p.styles.popper,ref:v}),{popper:p,placement:a,show:!!e.show,arrowProps:Object.assign({},p.attributes.arrow,{style:p.styles.arrow,ref:g})});return R=Se(d,f,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:R,onExit:C,onExiting:E,onExited:_,onEnter:b,onEntering:w,onEntered:T}),x?ye.createPortal(R,x):null});re.displayName="Overlay";const ae=i.forwardRef(({className:e,bsPrefix:s,as:t="div",...o},a)=>(s=P(s,"popover-header"),n.jsx(t,{ref:a,className:M(e,s),...o})));ae.displayName="PopoverHeader";const H=i.forwardRef(({className:e,bsPrefix:s,as:t="div",...o},a)=>(s=P(s,"popover-body"),n.jsx(t,{ref:a,className:M(e,s),...o})));H.displayName="PopoverBody";function le(e,s){let t=e;return e==="left"?t=s?"end":"start":e==="right"&&(t=s?"start":"end"),t}function ie(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const De=i.forwardRef(({bsPrefix:e,placement:s="right",className:t,style:o,children:a,body:l,arrowProps:r,hasDoneInitialMeasure:d,popper:f,show:u,...h},j)=>{const g=P(e,"popover"),v=se(),[x]=(s==null?void 0:s.split("-"))||[],m=le(x,v);let c=o;return u&&!d&&(c={...o,...ie(f==null?void 0:f.strategy)}),n.jsxs("div",{ref:j,role:"tooltip",style:c,"x-placement":x,className:M(t,g,x&&`bs-popover-${m}`),...h,children:[n.jsx("div",{className:"popover-arrow",...r}),l?n.jsx(H,{children:a}):a]})}),Ue=Object.assign(De,{Header:ae,Body:H,POPPER_OFFSET:[0,8]}),ce=i.forwardRef(({bsPrefix:e,placement:s="right",className:t,style:o,children:a,arrowProps:l,hasDoneInitialMeasure:r,popper:d,show:f,...u},h)=>{e=P(e,"tooltip");const j=se(),[g]=(s==null?void 0:s.split("-"))||[],v=le(g,j);let x=o;return f&&!r&&(x={...o,...ie(d==null?void 0:d.strategy)}),n.jsxs("div",{ref:h,style:x,role:"tooltip","x-placement":g,className:M(t,e,`bs-tooltip-${v}`),...u,children:[n.jsx("div",{className:"tooltip-arrow",...l}),n.jsx("div",{className:`${e}-inner`,children:a})]})});ce.displayName="Tooltip";const de=Object.assign(ce,{TOOLTIP_OFFSET:[0,6]});function Xe(e){const s=i.useRef(null),t=P(void 0,"popover"),o=P(void 0,"tooltip"),a=i.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(s.current){if(q(s.current,t))return Ue.POPPER_OFFSET;if(q(s.current,o))return de.TOOLTIP_OFFSET}return[0,0]}}}),[e,t,o]);return[s,[a]]}function Ae(e,s){const{ref:t}=e,{ref:o}=s;e.ref=t.__wrapped||(t.__wrapped=a=>t(X(a))),s.ref=o.__wrapped||(o.__wrapped=a=>o(X(a)))}const ue=i.forwardRef(({children:e,transition:s=Z,popperConfig:t={},rootClose:o=!1,placement:a="top",show:l=!1,...r},d)=>{const f=i.useRef({}),[u,h]=i.useState(null),[j,g]=Xe(r.offset),v=V(d,j),x=s===!0?Z:s||void 0,m=te(c=>{h(c),t==null||t.onFirstUpdate==null||t.onFirstUpdate(c)});return be(()=>{u&&r.target&&(f.current.scheduleUpdate==null||f.current.scheduleUpdate())},[u,r.target]),i.useEffect(()=>{l||h(null)},[l]),n.jsx(re,{...r,ref:v,popperConfig:{...t,modifiers:g.concat(t.modifiers||[]),onFirstUpdate:m},transition:x,rootClose:o,placement:a,show:l,children:(c,{arrowProps:y,popper:p,show:_})=>{var O,C;Ae(c,y);const E=p==null?void 0:p.placement,b=Object.assign(f.current,{state:p==null?void 0:p.state,scheduleUpdate:p==null?void 0:p.update,placement:E,outOfBoundaries:(p==null||(O=p.state)==null||(C=O.modifiersData.hide)==null?void 0:C.isReferenceHidden)||!1,strategy:t.strategy}),w=!!u;return typeof e=="function"?e({...c,placement:E,show:_,...!s&&_&&{className:"show"},popper:b,arrowProps:y,hasDoneInitialMeasure:w}):i.cloneElement(e,{...c,placement:E,arrowProps:y,popper:b,hasDoneInitialMeasure:w,className:M(e.props.className,!s&&_&&"show"),style:{...e.props.style,...c.style}})}})});ue.displayName="Overlay";function Ve(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function G(e,s,t){const[o]=s,a=o.currentTarget,l=o.relatedTarget||o.nativeEvent[t];(!l||l!==a)&&!Ee(a,l)&&e(...s)}_e.oneOf(["click","hover","focus"]);const ze=({trigger:e=["hover","focus"],overlay:s,children:t,popperConfig:o={},show:a,defaultShow:l=!1,onToggle:r,delay:d,placement:f,flip:u=f&&f.indexOf("auto")!==-1,...h})=>{const j=i.useRef(null),g=V(j,t.ref),v=Me(),x=i.useRef(""),[m,c]=we(a,l,r),y=Ve(d),{onFocus:p,onBlur:_,onClick:O}=typeof t!="function"?i.Children.only(t).props:{},C=k=>{g(X(k))},E=i.useCallback(()=>{if(v.clear(),x.current="show",!y.show){c(!0);return}v.set(()=>{x.current==="show"&&c(!0)},y.show)},[y.show,c,v]),b=i.useCallback(()=>{if(v.clear(),x.current="hide",!y.hide){c(!1);return}v.set(()=>{x.current==="hide"&&c(!1)},y.hide)},[y.hide,c,v]),w=i.useCallback((...k)=>{E(),p==null||p(...k)},[E,p]),T=i.useCallback((...k)=>{b(),_==null||_(...k)},[b,_]),R=i.useCallback((...k)=>{c(!m),O==null||O(...k)},[O,c,m]),B=i.useCallback((...k)=>{G(E,k,"fromElement")},[E]),fe=i.useCallback((...k)=>{G(b,k,"toElement")},[b]),L=e==null?[]:[].concat(e),F={ref:C};return L.indexOf("click")!==-1&&(F.onClick=R),L.indexOf("focus")!==-1&&(F.onFocus=w,F.onBlur=T),L.indexOf("hover")!==-1&&(F.onMouseOver=B,F.onMouseOut=fe),n.jsxs(n.Fragment,{children:[typeof t=="function"?t(F):i.cloneElement(t,F),n.jsx(ue,{...h,show:m,onHide:b,flip:u,placement:f,popperConfig:o,target:j.current,children:s})]})},He="_sidebar_s1ndk_1",Ie="_eosNote_s1ndk_1",S={sidebar:He,eosNote:Ie},Ze={"eos-plot":"_eos-plot_196cr_1"},J=1e3,$=2,Ke={displaylogo:!1,responsive:!0,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","autoScale2d","lasso2d","select2d"]},We=({configuration:e,eosPseudosMap:s,activePseudos:t})=>{const{pseudosMetadata:o}=i.useContext(z),a=i.useRef(null);return i.useEffect(()=>{if(!a.current)return;let l=null,r=null,d=!1,f=null;const u=Object.values(s).flatMap(g=>g.volumes||[]),h=Math.min(...u),j=Math.max(...u);return(async()=>{if(l=(await Ce(async()=>{const{default:m}=await import("./PlotlyLoader-Bz0pDYxL.js");return{default:m}},__vite__mapDeps([0,1,2,3]))).default,d||!a.current)return;const g=Object.entries(s).filter(([m])=>t.includes(m)).map(([m,c])=>{var _,O;const y=m.split("-Z=")[0],p=((_=o[y])==null?void 0:_.color)||"black";if(m!=="REF"&&c.volumes&&c.energies){const C=c.volumes.map((w,T)=>{var R;return{volume:w,energy:(((R=c.energies)==null?void 0:R[T])||0)-((c==null?void 0:c.E0)||0)}}).sort((w,T)=>w.volume-T.volume),E=C.map(w=>w.volume),b=C.map(w=>w.energy);return{x:E,y:b,mode:"lines+markers",type:"scatter",line:{shape:"spline"},name:m,marker:{color:p},hovertemplate:m+`<br>Volume = %{x:.${$}f} Å³/atom<br>Energy = %{y:.${$}f} eV/atom`+(c.nu?`<br>ν = ${(O=c.nu)==null?void 0:O.toFixed($)}`:"")+"<extra></extra>",hoverlabel:{align:"left"}}}else{const C=Array.from({length:J},(E,b)=>h+b*(j-h)/(J-1));return{x:C,y:qe(C,c.V0,0,c.B0,c.B1),mode:"lines",type:"scatter",line:{color:p},name:m,hovertemplate:m+`<br>Volume = %{x:.${$}f} Å³/atom<br>Energy = %{y:.${$}f} eV/atom<extra></extra>`,hoverlabel:{align:"left"}}}}),v={title:{text:$e(e),x:.55,y:.9},xaxis:{title:{text:"Volume [Å³/atom]",standoff:10},showgrid:!1},yaxis:{title:{text:"Energy [eV/atom]"},showgrid:!1},showlegend:!1,margin:{l:70,r:20,t:30,b:40},autosize:!0};r=await l.react(a.current,g,v,Ke);const x=m=>{m&&l&&l.Plots.resize(m)};f=()=>x(r),window.addEventListener("resize",f),f()})(),()=>{d=!0,f&&window.removeEventListener("resize",f)}},[t,e,s,o]),n.jsx("div",{ref:a,className:Ze["eos-plot"]})},qe=(e,s,t,o,a)=>e.map(l=>{const r=Math.pow(l/s,.6666666666666666);return t+9*o*s/16*(Math.pow(r-1,3)*a+Math.pow(r-1,2)*(6-4*r))}),Ye="_eosTable_lp80u_1",Ge="_gap_lp80u_11",Je="_nuTd_lp80u_21",N={eosTable:Ye,gap:Ge,nuTd:Je},Q=["SC","BCC","FCC","DC","XO","XO2","XO3","X2O","X2O3","X2O5"],Qe=({eosPseudosMap:e})=>{const{element:s}=i.useContext(ne);return n.jsxs(Oe,{id:N.eosTable,borderless:!0,responsive:!0,className:"text-center",children:[n.jsxs("thead",{children:[n.jsxs("tr",{children:[n.jsx("th",{rowSpan:2,children:"Library"}),n.jsxs("th",{rowSpan:2,children:["Z",n.jsx("sub",{children:"val"})]}),n.jsx("td",{rowSpan:2,className:N.gap}),n.jsx("th",{colSpan:2,children:"Rho Cutoff"}),n.jsx("td",{rowSpan:2,className:N.gap}),n.jsx("th",{colSpan:10,children:"ν"}),n.jsx("td",{rowSpan:2,className:N.gap}),n.jsx("th",{colSpan:2,children:"Average ν"})]}),n.jsxs("tr",{children:[n.jsx("th",{children:"Efficiency"}),n.jsx("th",{children:"Precision"}),Q.map(t=>{const o=t.includes("X")?t.replace("X",s):`${s}-${t==="DC"?"Diamond":t}`;return n.jsx("th",{children:et(o)},t)}),n.jsx("th",{className:"text-nowrap",children:"w/ max"}),n.jsx("th",{className:"text-nowrap",children:"w/o max"})]})]}),n.jsx("tbody",{children:e&&Object.entries(e).filter(([t])=>t.includes("-Z=")).map(([t,o])=>{const[a,l]=t.split("-Z=");return n.jsxs("tr",{children:[n.jsx("td",{children:a}),n.jsx("td",{children:l}),n.jsx("td",{className:N.gap}),Object.entries(e[t].ecutrho).map(([r,d])=>n.jsx("td",{children:d?d.toFixed(2):"-"},r)),n.jsx("td",{className:N.gap}),Q.map(r=>{var u,h;const d=(u=o.configurations[r])==null?void 0:u.nu,f=(h=o.configurations[r])==null?void 0:h.uuid;return n.jsx("td",{style:{backgroundColor:ee(d)},className:d!==void 0?N.nuTd:void 0,children:d!==void 0?n.jsx("a",{href:`https://www.materialscloud.org/explore/sssp-v2/${f}`,target:"_blank",className:"link-dark stretched-link sssp-link",children:d.toFixed(2)}):"-"},r)}),n.jsx("td",{className:N.gap}),Object.entries(e[t].avgNu).map(([r,d])=>n.jsx("td",{style:{backgroundColor:ee(d)},children:d!==void 0?d.toFixed(2):"-"},r))]},t)})})]})},et=e=>e.split(/(\d+)/).map((s,t)=>/\d+/.test(s)?n.jsx("sub",{children:s},t):s),ee=e=>e===void 0?"white":e<=.1?"#B7E1CD":e>=.33?"#EA9999":"#FFE599",U={"pseudos-checkboxes":"_pseudos-checkboxes_cplvb_1","pseudo-checkbox":"_pseudo-checkbox_cplvb_5"},tt=({pseudos:e,activePseudos:s,setActivePseudos:t})=>{const{pseudosMetadata:o}=i.useContext(z),[a,l]=i.useState(s.length===e.length);return n.jsxs("div",{className:U["pseudos-checkboxes"],children:[n.jsx(Y.Check,{type:"checkbox",id:"all",label:"Select all",checked:a,className:U["pseudo-checkbox"],style:{color:"black"},onChange:r=>{t(r.target.checked?e:["REF"]),l(r.target.checked)}}),e.map(r=>{var u;const d=r+(r==="REF"?" (AE average)":""),f=r.split("-Z=")[0];return n.jsx(Y.Check,{type:"checkbox",id:r,label:n.jsx(ze,{placement:"right",delay:{show:100,hide:100},offset:[0,10],overlay:n.jsx(de,{children:d}),children:n.jsx("span",{children:d})}),checked:s.includes(r),disabled:r==="REF",className:U["pseudo-checkbox"],style:{color:((u=o[f])==null?void 0:u.color)||"black"},onChange:h=>{t(h.target.checked?[...s,r]:s.filter(j=>j!==r)),l(h.target.checked?s.length+1===e.length:!1)}},r)})]})},at=()=>{const{element:e}=i.useContext(ne),{loadingMetadata:s}=i.useContext(z),{loadingPlotData:t,eosPseudosMap:o,eosPseudos:a,activeEosPseudos:l,setActiveEosPseudos:r}=i.useContext(ke),d=i.useMemo(()=>{const u={};return Object.entries(o).forEach(([h,j])=>{Object.entries(j.configurations).forEach(([g,v])=>{const x=g.includes("X")?g.replace("X",e):`${e}-${g==="DC"?"Diamond":g}`;u[x]||(u[x]={}),u[x][h]=v})}),u},[e,o]);return t||s?n.jsx(Re,{}):n.jsxs("div",{id:S.eosPane,children:[n.jsx(Ne,{title:`Equation of State: ${e}`}),a.length?n.jsxs("div",{id:S.eosContent,children:[n.jsx("div",{id:S.eosPlots,children:n.jsxs(K,{children:[n.jsx(D,{md:4,lg:3,id:S.sidebar,children:n.jsx(tt,{pseudos:a,activePseudos:l,setActivePseudos:r})}),n.jsxs(D,{children:[n.jsx(K,{children:Object.entries(d).map(([u,h])=>n.jsx(D,{lg:6,xl:4,children:n.jsx(We,{configuration:u,eosPseudosMap:h,activePseudos:l})},u))}),n.jsxs("div",{id:S.eosNote,children:["Comparison of equations of state for different pseudopotentials and their Birch-Murnaghan fits.",n.jsx("br",{}),'"REF (AE average)" refers to the all-electron average values from the reference dataset published in'," ",n.jsxs("a",{href:"https://www.nature.com/articles/s42254-023-00655-3",target:"_blank",children:["Bosoni et al., ",n.jsx("em",{children:"Nature Reviews Physics"})," ",n.jsx("b",{children:"6"}),", 45-58 (2024)"]})]})]})]})}),n.jsx("hr",{}),n.jsx(Qe,{eosPseudosMap:o})]}):n.jsx(Te,{})]})};export{at as default};
