const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlotlyLoader-D1f5blce.js","assets/index-BXdNk7sc.js","assets/index-Cjp2Xj_Y.css","assets/PlotlyLoader-CuCRB34y.css"])))=>i.map(i=>d[i]);
import{l as fe,r as d,V as he,n as te,o as me,W as xe,p as pe,x as H,y as z,X as ge,Y as ve,K as je,u as S,j as s,a as M,z as se,Z as ye,F as X,$ as A,a0 as we,q as be,P as Ee,D as I,_ as Oe,M as ke,O as Re,L as _e,Q as Z,U as L}from"./index-BXdNk7sc.js";import{F as K,N as Ce}from"./NoDataMessage-pfAAWmzJ.js";import{a as Ne,i as Te,u as W,r as Fe,h as q,f as Se}from"./utils-BArLr2f6.js";const V=2**31-1;function ne(e,t,n){const r=n-Date.now();e.current=r<=V?setTimeout(t,r):setTimeout(()=>ne(e,t,n),V)}function Pe(){const e=fe(),t=d.useRef();return Ne(()=>clearTimeout(t.current)),d.useMemo(()=>{const n=()=>clearTimeout(t.current);function r(a,l=0){e()&&(n(),l<=V?t.current=setTimeout(a,l):ne(t,a,Date.now()+l))}return{set:r,clear:n,handleRef:t}},[])}const Me=()=>{};function $e(e,t,{disabled:n,clickTrigger:r}={}){const a=t||Me;he(e,a,{disabled:n,clickTrigger:r});const l=te(o=>{Te(o)&&a(o)});d.useEffect(()=>{if(n||e==null)return;const o=me(xe(e));let h=(o.defaultView||window).event;const c=pe(o,"keyup",u=>{if(u===h){h=void 0;return}l(u)});return()=>{c()}},[e,n,l])}const oe=d.forwardRef((e,t)=>{const{flip:n,offset:r,placement:a,containerPadding:l,popperConfig:o={},transition:h,runTransition:c}=e,[u,x]=H(),[p,g]=H(),j=z(x,t),v=W(e.container),f=W(e.target),[i,y]=d.useState(!e.show),m=ge(f,u,ve({placement:a,enableEvents:!!e.show,containerPadding:l||5,flip:n,offset:r,arrowElement:p,popperConfig:o}));e.show&&i&&y(!1);const O=(...$)=>{y(!0),e.onExited&&e.onExited(...$)},R=e.show||!i;if($e(u,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!R)return null;const{onExit:k,onExiting:E,onEnter:w,onEntering:b,onEntered:N}=e;let C=e.children(Object.assign({},m.attributes.popper,{style:m.styles.popper,ref:j}),{popper:m,placement:a,show:!!e.show,arrowProps:Object.assign({},m.attributes.arrow,{style:m.styles.arrow,ref:g})});return C=Fe(h,c,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:C,onExit:k,onExiting:E,onExited:O,onEnter:w,onEntering:b,onEntered:N}),v?je.createPortal(C,v):null});oe.displayName="Overlay";const re=d.forwardRef(({className:e,bsPrefix:t,as:n="div",...r},a)=>(t=S(t,"popover-header"),s.jsx(n,{ref:a,className:M(e,t),...r})));re.displayName="PopoverHeader";const D=d.forwardRef(({className:e,bsPrefix:t,as:n="div",...r},a)=>(t=S(t,"popover-body"),s.jsx(n,{ref:a,className:M(e,t),...r})));D.displayName="PopoverBody";function ae(e,t){let n=e;return e==="left"?n=t?"end":"start":e==="right"&&(n=t?"start":"end"),n}function le(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const Be=d.forwardRef(({bsPrefix:e,placement:t="right",className:n,style:r,children:a,body:l,arrowProps:o,hasDoneInitialMeasure:h,popper:c,show:u,...x},p)=>{const g=S(e,"popover"),j=se(),[v]=(t==null?void 0:t.split("-"))||[],f=ae(v,j);let i=r;return u&&!h&&(i={...r,...le(c==null?void 0:c.strategy)}),s.jsxs("div",{ref:p,role:"tooltip",style:i,"x-placement":v,className:M(n,g,v&&`bs-popover-${f}`),...x,children:[s.jsx("div",{className:"popover-arrow",...o}),l?s.jsx(D,{children:a}):a]})}),Le=Object.assign(Be,{Header:re,Body:D,POPPER_OFFSET:[0,8]}),ce=d.forwardRef(({bsPrefix:e,placement:t="right",className:n,style:r,children:a,arrowProps:l,hasDoneInitialMeasure:o,popper:h,show:c,...u},x)=>{e=S(e,"tooltip");const p=se(),[g]=(t==null?void 0:t.split("-"))||[],j=ae(g,p);let v=r;return c&&!o&&(v={...r,...le(h==null?void 0:h.strategy)}),s.jsxs("div",{ref:x,style:v,role:"tooltip","x-placement":g,className:M(n,e,`bs-tooltip-${j}`),...u,children:[s.jsx("div",{className:"tooltip-arrow",...l}),s.jsx("div",{className:`${e}-inner`,children:a})]})});ce.displayName="Tooltip";const ie=Object.assign(ce,{TOOLTIP_OFFSET:[0,6]});function Ue(e){const t=d.useRef(null),n=S(void 0,"popover"),r=S(void 0,"tooltip"),a=d.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(t.current){if(q(t.current,n))return Le.POPPER_OFFSET;if(q(t.current,r))return ie.TOOLTIP_OFFSET}return[0,0]}}}),[e,n,r]);return[t,[a]]}function Ae(e,t){const{ref:n}=e,{ref:r}=t;e.ref=n.__wrapped||(n.__wrapped=a=>n(A(a))),t.ref=r.__wrapped||(r.__wrapped=a=>r(A(a)))}const de=d.forwardRef(({children:e,transition:t=X,popperConfig:n={},rootClose:r=!1,placement:a="top",show:l=!1,...o},h)=>{const c=d.useRef({}),[u,x]=d.useState(null),[p,g]=Ue(o.offset),j=z(h,p),v=t===!0?X:t||void 0,f=te(i=>{x(i),n==null||n.onFirstUpdate==null||n.onFirstUpdate(i)});return ye(()=>{u&&o.target&&(c.current.scheduleUpdate==null||c.current.scheduleUpdate())},[u,o.target]),d.useEffect(()=>{l||x(null)},[l]),s.jsx(oe,{...o,ref:j,popperConfig:{...n,modifiers:g.concat(n.modifiers||[]),onFirstUpdate:f},transition:v,rootClose:r,placement:a,show:l,children:(i,{arrowProps:y,popper:m,show:O})=>{var R,k;Ae(i,y);const E=m==null?void 0:m.placement,w=Object.assign(c.current,{state:m==null?void 0:m.state,scheduleUpdate:m==null?void 0:m.update,placement:E,outOfBoundaries:(m==null||(R=m.state)==null||(k=R.modifiersData.hide)==null?void 0:k.isReferenceHidden)||!1,strategy:n.strategy}),b=!!u;return typeof e=="function"?e({...i,placement:E,show:O,...!t&&O&&{className:"show"},popper:w,arrowProps:y,hasDoneInitialMeasure:b}):d.cloneElement(e,{...i,placement:E,arrowProps:y,popper:w,hasDoneInitialMeasure:b,className:M(e.props.className,!t&&O&&"show"),style:{...e.props.style,...i.style}})}})});de.displayName="Overlay";function Ve(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function Y(e,t,n){const[r]=t,a=r.currentTarget,l=r.relatedTarget||r.nativeEvent[n];(!l||l!==a)&&!be(a,l)&&e(...t)}Ee.oneOf(["click","hover","focus"]);const ze=({trigger:e=["hover","focus"],overlay:t,children:n,popperConfig:r={},show:a,defaultShow:l=!1,onToggle:o,delay:h,placement:c,flip:u=c&&c.indexOf("auto")!==-1,...x})=>{const p=d.useRef(null),g=z(p,n.ref),j=Pe(),v=d.useRef(""),[f,i]=we(a,l,o),y=Ve(h),{onFocus:m,onBlur:O,onClick:R}=typeof n!="function"?d.Children.only(n).props:{},k=_=>{g(A(_))},E=d.useCallback(()=>{if(j.clear(),v.current="show",!y.show){i(!0);return}j.set(()=>{v.current==="show"&&i(!0)},y.show)},[y.show,i,j]),w=d.useCallback(()=>{if(j.clear(),v.current="hide",!y.hide){i(!1);return}j.set(()=>{v.current==="hide"&&i(!1)},y.hide)},[y.hide,i,j]),b=d.useCallback((..._)=>{E(),m==null||m(..._)},[E,m]),N=d.useCallback((..._)=>{w(),O==null||O(..._)},[w,O]),C=d.useCallback((..._)=>{i(!f),R==null||R(..._)},[R,i,f]),$=d.useCallback((..._)=>{Y(E,_,"fromElement")},[E]),ue=d.useCallback((..._)=>{Y(w,_,"toElement")},[w]),B=e==null?[]:[].concat(e),T={ref:k};return B.indexOf("click")!==-1&&(T.onClick=C),B.indexOf("focus")!==-1&&(T.onFocus=b,T.onBlur=N),B.indexOf("hover")!==-1&&(T.onMouseOver=$,T.onMouseOut=ue),s.jsxs(s.Fragment,{children:[typeof n=="function"?n(T):d.cloneElement(n,T),s.jsx(de,{...x,show:f,onHide:w,flip:u,placement:c,popperConfig:r,target:p.current,children:t})]})},G={"eos-note":"_eos-note_b5i6i_1"},Ie={"eos-plot":"_eos-plot_1kkbs_1"},De=e=>e.split(/(\d+)/).map((t,n)=>/\d+/.test(t)?s.jsx("sub",{children:t},n):t),He=(e,t,n,r,a)=>e.map(l=>{const o=Math.pow(l/t,.6666666666666666);return n+9*r*t/16*(Math.pow(o-1,3)*a+Math.pow(o-1,2)*(6-4*o))}),Q=1e3,P=2,Xe={displaylogo:!1,responsive:!0,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","autoScale2d","lasso2d","select2d"]},Ze=({configuration:e,eosPseudosMap:t,activePseudos:n})=>{const{pseudosMetadata:r}=d.useContext(I),a=d.useRef(null);return d.useEffect(()=>{if(!a.current)return;let l=null,o=null,h=!1,c=null;const u=Object.values(t).flatMap(g=>g.volumes||[]),x=Math.min(...u),p=Math.max(...u);return(async()=>{if(l=(await Oe(async()=>{const{default:f}=await import("./PlotlyLoader-D1f5blce.js");return{default:f}},__vite__mapDeps([0,1,2,3]))).default,h||!a.current)return;const g=Object.entries(t).filter(([f])=>n.includes(f)).map(([f,i])=>{var O,R;const y=f.split("-Z=")[0],m=((O=r[y])==null?void 0:O.color)||"black";if(f!=="REF"&&i.volumes&&i.energies){const k=i.volumes.map((b,N)=>{var C;return{volume:b,energy:(((C=i.energies)==null?void 0:C[N])||0)-((i==null?void 0:i.E0)||0)}}).sort((b,N)=>b.volume-N.volume),E=k.map(b=>b.volume),w=k.map(b=>b.energy);return{x:E,y:w,mode:"lines+markers",type:"scatter",line:{shape:"spline"},name:f,marker:{color:m},hovertemplate:f+`<br>Volume = %{x:.${P}f} Å³/atom<br>Energy = %{y:.${P}f} eV/atom`+(i.nu?`<br>ν = ${(R=i.nu)==null?void 0:R.toFixed(P)}`:"")+"<extra></extra>",hoverlabel:{align:"left"}}}else{const k=Array.from({length:Q},(E,w)=>x+w*(p-x)/(Q-1));return{x:k,y:He(k,i.V0,0,i.B0,i.B1),mode:"lines",type:"scatter",line:{color:m},name:f,hovertemplate:f+`<br>Volume = %{x:.${P}f} Å³/atom<br>Energy = %{y:.${P}f} eV/atom<extra></extra>`,hoverlabel:{align:"left"}}}}),j={title:{text:Se(e),x:.55,y:.9},xaxis:{title:{text:"Volume [Å³/atom]",standoff:10},showgrid:!1},yaxis:{title:{text:"Energy [eV/atom]"},showgrid:!1},showlegend:!1,margin:{l:70,r:20,t:30,b:40},autosize:!0};o=await l.react(a.current,g,j,Xe);const v=f=>{f&&l.Plots.resize(f)};c=()=>v(o),window.addEventListener("resize",c),c()})(),()=>{if(h=!0,c&&window.removeEventListener("resize",c),l&&o)try{l.purge(o)}catch(g){console.error("Error purging EosPlot:",g)}}},[n]),s.jsx("div",{ref:a,className:Ie["eos-plot"]})},Ke="_gap_1g19a_18",We="_nuTd_1g19a_27",F={gap:Ke,nuTd:We},J=["SC","BCC","FCC","DC","XO","XO2","XO3","X2O","X2O3","X2O5"],qe=({eosPseudosMap:e})=>s.jsxs(ke,{borderless:!0,responsive:!0,className:"text-center",children:[s.jsxs("thead",{children:[s.jsxs("tr",{children:[s.jsx("th",{rowSpan:2,children:"Library"}),s.jsxs("th",{rowSpan:2,children:["Z",s.jsx("sub",{children:"val"})]}),s.jsx("td",{rowSpan:2,className:F.gap}),s.jsx("th",{colSpan:2,children:"Rho Cutoff"}),s.jsx("td",{rowSpan:2,className:F.gap}),s.jsx("th",{colSpan:10,children:"ν"}),s.jsx("td",{rowSpan:2,className:F.gap}),s.jsx("th",{colSpan:2,children:"Average ν"})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Efficiency"}),s.jsx("th",{children:"Precision"}),J.map(t=>s.jsx("th",{children:De(t)},t)),s.jsx("th",{className:"text-nowrap",children:"w/ max"}),s.jsx("th",{className:"text-nowrap",children:"w/o max"})]})]}),s.jsx("tbody",{children:e&&Object.entries(e).filter(([t])=>t.includes("-Z=")).map(([t,n])=>{const[r,a]=t.split("-Z=");return s.jsxs("tr",{children:[s.jsx("td",{children:r}),s.jsx("td",{children:a}),s.jsx("td",{className:F.gap}),Object.entries(e[t].ecutrho).map(([l,o])=>s.jsx("td",{children:o?o.toFixed(2):"-"},l)),s.jsx("td",{className:F.gap}),J.map(l=>{var c,u;const o=(c=n.configurations[l])==null?void 0:c.nu,h=(u=n.configurations[l])==null?void 0:u.uuid;return s.jsx("td",{style:{backgroundColor:ee(o)},className:o!==void 0?F.nuTd:void 0,children:o!==void 0?s.jsx("a",{href:`https://www.materialscloud.org/explore/sssp-v2/${h}`,target:"_blank",className:"link-dark stretched-link sssp-link",children:o.toFixed(2)}):"-"},l)}),s.jsx("td",{className:F.gap}),Object.entries(e[t].avgNu).map(([l,o])=>s.jsx("td",{style:{backgroundColor:ee(o)},children:o!==void 0?o.toFixed(2):"-"},l))]},t)})})]}),ee=e=>e===void 0?"white":e<=.1?"#B7E1CD":e>=.33?"#EA9999":"#FFE599",U={"pseudos-checkboxes":"_pseudos-checkboxes_cplvb_1","pseudo-checkbox":"_pseudo-checkbox_cplvb_5"},Ye=({pseudos:e,activePseudos:t,setActivePseudos:n})=>{const{pseudosMetadata:r}=d.useContext(I),[a,l]=d.useState(t.length===e.length);return s.jsxs("div",{className:U["pseudos-checkboxes"],children:[s.jsx(K.Check,{type:"checkbox",id:"all",label:"Select all",checked:a,className:U["pseudo-checkbox"],style:{color:"black"},onChange:o=>{n(o.target.checked?e:["REF"]),l(o.target.checked)}}),e.map(o=>{var u;const h=o+(o==="REF"?" (AE average)":""),c=o.split("-Z=")[0];return s.jsx(K.Check,{type:"checkbox",id:o,label:s.jsx(ze,{placement:"right",delay:{show:100,hide:100},offset:[0,10],overlay:s.jsx(ie,{children:h}),children:s.jsx("span",{children:h})}),checked:t.includes(o),disabled:o==="REF",className:U["pseudo-checkbox"],style:{color:((u=r[c])==null?void 0:u.color)||"black"},onChange:x=>{n(x.target.checked?[...t,o]:t.filter(p=>p!==o)),l(x.target.checked?t.length+1===e.length:!1)}},o)})]})},et=()=>{const{loadingMetadata:e}=d.useContext(I),{loadingEosData:t,eosPseudosMap:n,eosPseudos:r,activeEosPseudos:a,setActiveEosPseudos:l}=d.useContext(Re),o=d.useMemo(()=>{const c={};return Object.entries(n).forEach(([u,x])=>{Object.entries(x.configurations).forEach(([p,g])=>{c[p]||(c[p]={}),c[p][u]=g})}),c},[n]);return t||e?s.jsx(_e,{}):r.length?s.jsxs("div",{id:"eos-pane",children:[s.jsx("div",{id:"eos-plots",children:s.jsxs(Z,{children:[s.jsx(L,{md:4,lg:3,xxl:2,className:G["pseudo-controls"],children:s.jsx(Ye,{pseudos:r,activePseudos:a,setActivePseudos:l})}),s.jsxs(L,{children:[s.jsx(Z,{children:Object.entries(o).map(([c,u])=>s.jsx(L,{lg:6,xl:4,xxl:3,children:s.jsx(Ze,{configuration:c,eosPseudosMap:u,activePseudos:a})},c))}),s.jsxs("div",{id:G["eos-note"],children:["Comparison of equations of state for different pseudopotentials and their Birch-Murnaghan fits.",s.jsx("br",{}),'"REF (AE average)" refers to the all-electron average values from the reference dataset published in'," ",s.jsxs("a",{href:"https://www.nature.com/articles/s42254-023-00655-3",target:"_blank",children:["Bosoni et al., ",s.jsx("em",{children:"Nature Reviews Physics"})," ",s.jsx("b",{children:"6"}),", 45-58 (2024)"]})]})]})]})}),s.jsx("hr",{}),s.jsx(qe,{eosPseudosMap:n})]}):s.jsx(Ce,{})};export{et as default};
